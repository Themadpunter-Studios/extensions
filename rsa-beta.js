(function(Scratch) {
    'use strict';

    // Load the JSEncrypt library from a CDN
    const script = document.createElement('script');
    script.src = 'data:text/plain;base64,LyohIEZvciBsaWNlbnNlIGluZm9ybWF0aW9uIHBsZWFzZSBzZWUganNlbmNyeXB0Lm1pbi5qcy5MSUNFTlNFLnR4dCAqLw0KIWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10sZSk6Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuSlNFbmNyeXB0PWUoKTp0LkpTRW5jcnlwdD1lKCl9KHdpbmRvdywoKCk9PigoKT0+e3ZhciB0PXsxNTU6dD0+e3ZhciBlLGkscj10LmV4cG9ydHM9e307ZnVuY3Rpb24gbigpe3Rocm93IG5ldyBFcnJvcigic2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpfWZ1bmN0aW9uIHMoKXt0aHJvdyBuZXcgRXJyb3IoImNsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpfWZ1bmN0aW9uIG8odCl7aWYoZT09PXNldFRpbWVvdXQpcmV0dXJuIHNldFRpbWVvdXQodCwwKTtpZigoZT09PW58fCFlKSYmc2V0VGltZW91dClyZXR1cm4gZT1zZXRUaW1lb3V0LHNldFRpbWVvdXQodCwwKTt0cnl7cmV0dXJuIGUodCwwKX1jYXRjaChpKXt0cnl7cmV0dXJuIGUuY2FsbChudWxsLHQsMCl9Y2F0Y2goaSl7cmV0dXJuIGUuY2FsbCh0aGlzLHQsMCl9fX0hZnVuY3Rpb24oKXt0cnl7ZT0iZnVuY3Rpb24iPT10eXBlb2Ygc2V0VGltZW91dD9zZXRUaW1lb3V0Om59Y2F0Y2godCl7ZT1ufXRyeXtpPSJmdW5jdGlvbiI9PXR5cGVvZiBjbGVhclRpbWVvdXQ/Y2xlYXJUaW1lb3V0OnN9Y2F0Y2godCl7aT1zfX0oKTt2YXIgaCxhPVtdLHU9ITEsYz0tMTtmdW5jdGlvbiBmKCl7dSYmaCYmKHU9ITEsaC5sZW5ndGg/YT1oLmNvbmNhdChhKTpjPS0xLGEubGVuZ3RoJiZsKCkpfWZ1bmN0aW9uIGwoKXtpZighdSl7dmFyIHQ9byhmKTt1PSEwO2Zvcih2YXIgZT1hLmxlbmd0aDtlOyl7Zm9yKGg9YSxhPVtdOysrYzxlOyloJiZoW2NdLnJ1bigpO2M9LTEsZT1hLmxlbmd0aH1oPW51bGwsdT0hMSxmdW5jdGlvbih0KXtpZihpPT09Y2xlYXJUaW1lb3V0KXJldHVybiBjbGVhclRpbWVvdXQodCk7aWYoKGk9PT1zfHwhaSkmJmNsZWFyVGltZW91dClyZXR1cm4gaT1jbGVhclRpbWVvdXQsY2xlYXJUaW1lb3V0KHQpO3RyeXtyZXR1cm4gaSh0KX1jYXRjaChlKXt0cnl7cmV0dXJuIGkuY2FsbChudWxsLHQpfWNhdGNoKGUpe3JldHVybiBpLmNhbGwodGhpcyx0KX19fSh0KX19ZnVuY3Rpb24gcCh0LGUpe3RoaXMuZnVuPXQsdGhpcy5hcnJheT1lfWZ1bmN0aW9uIGcoKXt9ci5uZXh0VGljaz1mdW5jdGlvbih0KXt2YXIgZT1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aC0xKTtpZihhcmd1bWVudHMubGVuZ3RoPjEpZm9yKHZhciBpPTE7aTxhcmd1bWVudHMubGVuZ3RoO2krKyllW2ktMV09YXJndW1lbnRzW2ldO2EucHVzaChuZXcgcCh0LGUpKSwxIT09YS5sZW5ndGh8fHV8fG8obCl9LHAucHJvdG90eXBlLnJ1bj1mdW5jdGlvbigpe3RoaXMuZnVuLmFwcGx5KG51bGwsdGhpcy5hcnJheSl9LHIudGl0bGU9ImJyb3dzZXIiLHIuYnJvd3Nlcj0hMCxyLmVudj17fSxyLmFyZ3Y9W10sci52ZXJzaW9uPSIiLHIudmVyc2lvbnM9e30sci5vbj1nLHIuYWRkTGlzdGVuZXI9ZyxyLm9uY2U9ZyxyLm9mZj1nLHIucmVtb3ZlTGlzdGVuZXI9ZyxyLnJlbW92ZUFsbExpc3RlbmVycz1nLHIuZW1pdD1nLHIucHJlcGVuZExpc3RlbmVyPWcsci5wcmVwZW5kT25jZUxpc3RlbmVyPWcsci5saXN0ZW5lcnM9ZnVuY3Rpb24odCl7cmV0dXJuW119LHIuYmluZGluZz1mdW5jdGlvbih0KXt0aHJvdyBuZXcgRXJyb3IoInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkIil9LHIuY3dkPWZ1bmN0aW9uKCl7cmV0dXJuIi8ifSxyLmNoZGlyPWZ1bmN0aW9uKHQpe3Rocm93IG5ldyBFcnJvcigicHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkIil9LHIudW1hc2s9ZnVuY3Rpb24oKXtyZXR1cm4gMH19fSxlPXt9O2Z1bmN0aW9uIGkocil7dmFyIG49ZVtyXTtpZih2b2lkIDAhPT1uKXJldHVybiBuLmV4cG9ydHM7dmFyIHM9ZVtyXT17ZXhwb3J0czp7fX07cmV0dXJuIHRbcl0ocyxzLmV4cG9ydHMsaSkscy5leHBvcnRzfWkuZD0odCxlKT0+e2Zvcih2YXIgciBpbiBlKWkubyhlLHIpJiYhaS5vKHQscikmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LHIse2VudW1lcmFibGU6ITAsZ2V0OmVbcl19KX0saS5vPSh0LGUpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxlKTt2YXIgcj17fTtyZXR1cm4oKCk9PnsidXNlIHN0cmljdCI7aS5kKHIse2RlZmF1bHQ6KCk9PmN0fSk7dmFyIHQ9IjAxMjM0NTY3ODlhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiI7ZnVuY3Rpb24gZShlKXtyZXR1cm4gdC5jaGFyQXQoZSl9ZnVuY3Rpb24gbih0LGUpe3JldHVybiB0JmV9ZnVuY3Rpb24gcyh0LGUpe3JldHVybiB0fGV9ZnVuY3Rpb24gbyh0LGUpe3JldHVybiB0XmV9ZnVuY3Rpb24gaCh0LGUpe3JldHVybiB0Jn5lfWZ1bmN0aW9uIGEodCl7aWYoMD09dClyZXR1cm4tMTt2YXIgZT0wO3JldHVybiAwPT0oNjU1MzUmdCkmJih0Pj49MTYsZSs9MTYpLDA9PSgyNTUmdCkmJih0Pj49OCxlKz04KSwwPT0oMTUmdCkmJih0Pj49NCxlKz00KSwwPT0oMyZ0KSYmKHQ+Pj0yLGUrPTIpLDA9PSgxJnQpJiYrK2UsZX1mdW5jdGlvbiB1KHQpe2Zvcih2YXIgZT0wOzAhPXQ7KXQmPXQtMSwrK2U7cmV0dXJuIGV9dmFyIGMsZj0iQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyIsbD0iPSI7ZnVuY3Rpb24gcCh0KXt2YXIgZSxpLHI9IiI7Zm9yKGU9MDtlKzM8PXQubGVuZ3RoO2UrPTMpaT1wYXJzZUludCh0LnN1YnN0cmluZyhlLGUrMyksMTYpLHIrPWYuY2hhckF0KGk+PjYpK2YuY2hhckF0KDYzJmkpO2ZvcihlKzE9PXQubGVuZ3RoPyhpPXBhcnNlSW50KHQuc3Vic3RyaW5nKGUsZSsxKSwxNikscis9Zi5jaGFyQXQoaTw8MikpOmUrMj09dC5sZW5ndGgmJihpPXBhcnNlSW50KHQuc3Vic3RyaW5nKGUsZSsyKSwxNikscis9Zi5jaGFyQXQoaT4+MikrZi5jaGFyQXQoKDMmaSk8PDQpKTsoMyZyLmxlbmd0aCk+MDspcis9bDtyZXR1cm4gcn1mdW5jdGlvbiBnKHQpe3ZhciBpLHI9IiIsbj0wLHM9MDtmb3IoaT0wO2k8dC5sZW5ndGgmJnQuY2hhckF0KGkpIT1sOysraSl7dmFyIG89Zi5pbmRleE9mKHQuY2hhckF0KGkpKTtvPDB8fCgwPT1uPyhyKz1lKG8+PjIpLHM9MyZvLG49MSk6MT09bj8ocis9ZShzPDwyfG8+PjQpLHM9MTUmbyxuPTIpOjI9PW4/KHIrPWUocykscis9ZShvPj4yKSxzPTMmbyxuPTMpOihyKz1lKHM8PDJ8bz4+NCkscis9ZSgxNSZvKSxuPTApKX1yZXR1cm4gMT09biYmKHIrPWUoczw8MikpLHJ9dmFyIGQsdj17ZGVjb2RlOmZ1bmN0aW9uKHQpe3ZhciBlO2lmKHZvaWQgMD09PWQpe3ZhciBpPSI9IFxmXG5cclx0IFx1MjAyOFx1MjAyOSI7Zm9yKGQ9T2JqZWN0LmNyZWF0ZShudWxsKSxlPTA7ZTw2NDsrK2UpZFsiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyIuY2hhckF0KGUpXT1lO2ZvcihkWyItIl09NjIsZC5fPTYzLGU9MDtlPGkubGVuZ3RoOysrZSlkW2kuY2hhckF0KGUpXT0tMX12YXIgcj1bXSxuPTAscz0wO2ZvcihlPTA7ZTx0Lmxlbmd0aDsrK2Upe3ZhciBvPXQuY2hhckF0KGUpO2lmKCI9Ij09bylicmVhaztpZigtMSE9KG89ZFtvXSkpe2lmKHZvaWQgMD09PW8pdGhyb3cgbmV3IEVycm9yKCJJbGxlZ2FsIGNoYXJhY3RlciBhdCBvZmZzZXQgIitlKTtufD1vLCsrcz49ND8ocltyLmxlbmd0aF09bj4+MTYscltyLmxlbmd0aF09bj4+OCYyNTUscltyLmxlbmd0aF09MjU1Jm4sbj0wLHM9MCk6bjw8PTZ9fXN3aXRjaChzKXtjYXNlIDE6dGhyb3cgbmV3IEVycm9yKCJCYXNlNjQgZW5jb2RpbmcgaW5jb21wbGV0ZTogYXQgbGVhc3QgMiBiaXRzIG1pc3NpbmciKTtjYXNlIDI6cltyLmxlbmd0aF09bj4+MTA7YnJlYWs7Y2FzZSAzOnJbci5sZW5ndGhdPW4+PjE2LHJbci5sZW5ndGhdPW4+PjgmMjU1fXJldHVybiByfSxyZTovLS0tLS1CRUdJTiBbXi1dKy0tLS0tKFtBLVphLXowLTkrXC89XHNdKyktLS0tLUVORCBbXi1dKy0tLS0tfGJlZ2luLWJhc2U2NFteXG5dK1xuKFtBLVphLXowLTkrXC89XHNdKyk9PT09Lyx1bmFybW9yOmZ1bmN0aW9uKHQpe3ZhciBlPXYucmUuZXhlYyh0KTtpZihlKWlmKGVbMV0pdD1lWzFdO2Vsc2V7aWYoIWVbMl0pdGhyb3cgbmV3IEVycm9yKCJSZWdFeHAgb3V0IG9mIHN5bmMiKTt0PWVbMl19cmV0dXJuIHYuZGVjb2RlKHQpfX0sbT0xZTEzLHk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuYnVmPVsrdHx8MF19cmV0dXJuIHQucHJvdG90eXBlLm11bEFkZD1mdW5jdGlvbih0LGUpe3ZhciBpLHIsbj10aGlzLmJ1ZixzPW4ubGVuZ3RoO2ZvcihpPTA7aTxzOysraSkocj1uW2ldKnQrZSk8bT9lPTA6ci09KGU9MHxyL20pKm0sbltpXT1yO2U+MCYmKG5baV09ZSl9LHQucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih0KXt2YXIgZSxpLHI9dGhpcy5idWYsbj1yLmxlbmd0aDtmb3IoZT0wO2U8bjsrK2UpKGk9cltlXS10KTwwPyhpKz1tLHQ9MSk6dD0wLHJbZV09aTtmb3IoOzA9PT1yW3IubGVuZ3RoLTFdOylyLnBvcCgpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbih0KXtpZigxMCE9KHR8fDEwKSl0aHJvdyBuZXcgRXJyb3IoIm9ubHkgYmFzZSAxMCBpcyBzdXBwb3J0ZWQiKTtmb3IodmFyIGU9dGhpcy5idWYsaT1lW2UubGVuZ3RoLTFdLnRvU3RyaW5nKCkscj1lLmxlbmd0aC0yO3I+PTA7LS1yKWkrPShtK2Vbcl0pLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDEpO3JldHVybiBpfSx0LnByb3RvdHlwZS52YWx1ZU9mPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuYnVmLGU9MCxpPXQubGVuZ3RoLTE7aT49MDstLWkpZT1lKm0rdFtpXTtyZXR1cm4gZX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmJ1ZjtyZXR1cm4gMT09dC5sZW5ndGg/dFswXTp0aGlzfSx0fSgpLGI9IuKApiIsVD0vXihcZFxkKSgwWzEtOV18MVswLTJdKSgwWzEtOV18WzEyXVxkfDNbMDFdKShbMDFdXGR8MlswLTNdKSg/OihbMC01XVxkKSg/OihbMC01XVxkKSg/OlsuLF0oXGR7MSwzfSkpPyk/KT8oWnxbLStdKD86WzBdXGR8MVswLTJdKShbMC01XVxkKT8pPyQvLFM9L14oXGRcZFxkXGQpKDBbMS05XXwxWzAtMl0pKDBbMS05XXxbMTJdXGR8M1swMV0pKFswMV1cZHwyWzAtM10pKD86KFswLTVdXGQpKD86KFswLTVdXGQpKD86Wy4sXShcZHsxLDN9KSk/KT8pPyhafFstK10oPzpbMF1cZHwxWzAtMl0pKFswLTVdXGQpPyk/JC87ZnVuY3Rpb24gRSh0LGUpe3JldHVybiB0Lmxlbmd0aD5lJiYodD10LnN1YnN0cmluZygwLGUpK2IpLHR9dmFyIHcsRD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSxpKXt0aGlzLmhleERpZ2l0cz0iMDEyMzQ1Njc4OUFCQ0RFRiIsZSBpbnN0YW5jZW9mIHQ/KHRoaXMuZW5jPWUuZW5jLHRoaXMucG9zPWUucG9zKToodGhpcy5lbmM9ZSx0aGlzLnBvcz1pKX1yZXR1cm4gdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXQmJih0PXRoaXMucG9zKyspLHQ+PXRoaXMuZW5jLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlJlcXVlc3RpbmcgYnl0ZSBvZmZzZXQgIi5jb25jYXQodCwiIG9uIGEgc3RyZWFtIG9mIGxlbmd0aCAiKS5jb25jYXQodGhpcy5lbmMubGVuZ3RoKSk7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0aGlzLmVuYz90aGlzLmVuYy5jaGFyQ29kZUF0KHQpOnRoaXMuZW5jW3RdfSx0LnByb3RvdHlwZS5oZXhCeXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmhleERpZ2l0cy5jaGFyQXQodD4+NCYxNSkrdGhpcy5oZXhEaWdpdHMuY2hhckF0KDE1JnQpfSx0LnByb3RvdHlwZS5oZXhEdW1wPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIHI9IiIsbj10O248ZTsrK24paWYocis9dGhpcy5oZXhCeXRlKHRoaXMuZ2V0KG4pKSwhMCE9PWkpc3dpdGNoKDE1Jm4pe2Nhc2UgNzpyKz0iICAiO2JyZWFrO2Nhc2UgMTU6cis9IlxuIjticmVhaztkZWZhdWx0OnIrPSIgIn1yZXR1cm4gcn0sdC5wcm90b3R5cGUuaXNBU0NJST1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10O2k8ZTsrK2kpe3ZhciByPXRoaXMuZ2V0KGkpO2lmKHI8MzJ8fHI+MTc2KXJldHVybiExfXJldHVybiEwfSx0LnByb3RvdHlwZS5wYXJzZVN0cmluZ0lTTz1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0iIixyPXQ7cjxlOysrcilpKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMuZ2V0KHIpKTtyZXR1cm4gaX0sdC5wcm90b3R5cGUucGFyc2VTdHJpbmdVVEY9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9IiIscj10O3I8ZTspe3ZhciBuPXRoaXMuZ2V0KHIrKyk7aSs9bjwxMjg/U3RyaW5nLmZyb21DaGFyQ29kZShuKTpuPjE5MSYmbjwyMjQ/U3RyaW5nLmZyb21DaGFyQ29kZSgoMzEmbik8PDZ8NjMmdGhpcy5nZXQocisrKSk6U3RyaW5nLmZyb21DaGFyQ29kZSgoMTUmbik8PDEyfCg2MyZ0aGlzLmdldChyKyspKTw8Nnw2MyZ0aGlzLmdldChyKyspKX1yZXR1cm4gaX0sdC5wcm90b3R5cGUucGFyc2VTdHJpbmdCTVA9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkscixuPSIiLHM9dDtzPGU7KWk9dGhpcy5nZXQocysrKSxyPXRoaXMuZ2V0KHMrKyksbis9U3RyaW5nLmZyb21DaGFyQ29kZShpPDw4fHIpO3JldHVybiBufSx0LnByb3RvdHlwZS5wYXJzZVRpbWU9ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMucGFyc2VTdHJpbmdJU08odCxlKSxuPShpP1Q6UykuZXhlYyhyKTtyZXR1cm4gbj8oaSYmKG5bMV09K25bMV0sblsxXSs9K25bMV08NzA/MmUzOjE5MDApLHI9blsxXSsiLSIrblsyXSsiLSIrblszXSsiICIrbls0XSxuWzVdJiYocis9IjoiK25bNV0sbls2XSYmKHIrPSI6IituWzZdLG5bN10mJihyKz0iLiIrbls3XSkpKSxuWzhdJiYocis9IiBVVEMiLCJaIiE9bls4XSYmKHIrPW5bOF0sbls5XSYmKHIrPSI6IituWzldKSkpLHIpOiJVbnJlY29nbml6ZWQgdGltZTogIityfSx0LnByb3RvdHlwZS5wYXJzZUludGVnZXI9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkscj10aGlzLmdldCh0KSxuPXI+MTI3LHM9bj8yNTU6MCxvPSIiO3I9PXMmJisrdDxlOylyPXRoaXMuZ2V0KHQpO2lmKDA9PShpPWUtdCkpcmV0dXJuIG4/LTE6MDtpZihpPjQpe2ZvcihvPXIsaTw8PTM7MD09KDEyOCYoK29ecykpOylvPStvPDwxLC0taTtvPSIoIitpKyIgYml0KVxuIn1uJiYoci09MjU2KTtmb3IodmFyIGg9bmV3IHkociksYT10KzE7YTxlOysrYSloLm11bEFkZCgyNTYsdGhpcy5nZXQoYSkpO3JldHVybiBvK2gudG9TdHJpbmcoKX0sdC5wcm90b3R5cGUucGFyc2VCaXRTdHJpbmc9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgcj10aGlzLmdldCh0KSxuPSIoIisoKGUtdC0xPDwzKS1yKSsiIGJpdClcbiIscz0iIixvPXQrMTtvPGU7KytvKXtmb3IodmFyIGg9dGhpcy5nZXQobyksYT1vPT1lLTE/cjowLHU9Nzt1Pj1hOy0tdSlzKz1oPj51JjE/IjEiOiIwIjtpZihzLmxlbmd0aD5pKXJldHVybiBuK0UocyxpKX1yZXR1cm4gbitzfSx0LnByb3RvdHlwZS5wYXJzZU9jdGV0U3RyaW5nPWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLmlzQVNDSUkodCxlKSlyZXR1cm4gRSh0aGlzLnBhcnNlU3RyaW5nSVNPKHQsZSksaSk7dmFyIHI9ZS10LG49IigiK3IrIiBieXRlKVxuIjtyPihpLz0yKSYmKGU9dCtpKTtmb3IodmFyIHM9dDtzPGU7KytzKW4rPXRoaXMuaGV4Qnl0ZSh0aGlzLmdldChzKSk7cmV0dXJuIHI+aSYmKG4rPWIpLG59LHQucHJvdG90eXBlLnBhcnNlT0lEPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIHI9IiIsbj1uZXcgeSxzPTAsbz10O288ZTsrK28pe3ZhciBoPXRoaXMuZ2V0KG8pO2lmKG4ubXVsQWRkKDEyOCwxMjcmaCkscys9NywhKDEyOCZoKSl7aWYoIiI9PT1yKWlmKChuPW4uc2ltcGxpZnkoKSlpbnN0YW5jZW9mIHkpbi5zdWIoODApLHI9IjIuIituLnRvU3RyaW5nKCk7ZWxzZXt2YXIgYT1uPDgwP248NDA/MDoxOjI7cj1hKyIuIisobi00MCphKX1lbHNlIHIrPSIuIituLnRvU3RyaW5nKCk7aWYoci5sZW5ndGg+aSlyZXR1cm4gRShyLGkpO249bmV3IHkscz0wfX1yZXR1cm4gcz4wJiYocis9Ii5pbmNvbXBsZXRlIikscn0sdH0oKSx4PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxyLG4pe2lmKCEociBpbnN0YW5jZW9mIFIpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB0YWcgdmFsdWUuIik7dGhpcy5zdHJlYW09dCx0aGlzLmhlYWRlcj1lLHRoaXMubGVuZ3RoPWksdGhpcy50YWc9cix0aGlzLnN1Yj1ufXJldHVybiB0LnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3N3aXRjaCh0aGlzLnRhZy50YWdDbGFzcyl7Y2FzZSAwOnN3aXRjaCh0aGlzLnRhZy50YWdOdW1iZXIpe2Nhc2UgMDpyZXR1cm4iRU9DIjtjYXNlIDE6cmV0dXJuIkJPT0xFQU4iO2Nhc2UgMjpyZXR1cm4iSU5URUdFUiI7Y2FzZSAzOnJldHVybiJCSVRfU1RSSU5HIjtjYXNlIDQ6cmV0dXJuIk9DVEVUX1NUUklORyI7Y2FzZSA1OnJldHVybiJOVUxMIjtjYXNlIDY6cmV0dXJuIk9CSkVDVF9JREVOVElGSUVSIjtjYXNlIDc6cmV0dXJuIk9iamVjdERlc2NyaXB0b3IiO2Nhc2UgODpyZXR1cm4iRVhURVJOQUwiO2Nhc2UgOTpyZXR1cm4iUkVBTCI7Y2FzZSAxMDpyZXR1cm4iRU5VTUVSQVRFRCI7Y2FzZSAxMTpyZXR1cm4iRU1CRURERURfUERWIjtjYXNlIDEyOnJldHVybiJVVEY4U3RyaW5nIjtjYXNlIDE2OnJldHVybiJTRVFVRU5DRSI7Y2FzZSAxNzpyZXR1cm4iU0VUIjtjYXNlIDE4OnJldHVybiJOdW1lcmljU3RyaW5nIjtjYXNlIDE5OnJldHVybiJQcmludGFibGVTdHJpbmciO2Nhc2UgMjA6cmV0dXJuIlRlbGV0ZXhTdHJpbmciO2Nhc2UgMjE6cmV0dXJuIlZpZGVvdGV4U3RyaW5nIjtjYXNlIDIyOnJldHVybiJJQTVTdHJpbmciO2Nhc2UgMjM6cmV0dXJuIlVUQ1RpbWUiO2Nhc2UgMjQ6cmV0dXJuIkdlbmVyYWxpemVkVGltZSI7Y2FzZSAyNTpyZXR1cm4iR3JhcGhpY1N0cmluZyI7Y2FzZSAyNjpyZXR1cm4iVmlzaWJsZVN0cmluZyI7Y2FzZSAyNzpyZXR1cm4iR2VuZXJhbFN0cmluZyI7Y2FzZSAyODpyZXR1cm4iVW5pdmVyc2FsU3RyaW5nIjtjYXNlIDMwOnJldHVybiJCTVBTdHJpbmcifXJldHVybiJVbml2ZXJzYWxfIit0aGlzLnRhZy50YWdOdW1iZXIudG9TdHJpbmcoKTtjYXNlIDE6cmV0dXJuIkFwcGxpY2F0aW9uXyIrdGhpcy50YWcudGFnTnVtYmVyLnRvU3RyaW5nKCk7Y2FzZSAyOnJldHVybiJbIit0aGlzLnRhZy50YWdOdW1iZXIudG9TdHJpbmcoKSsiXSI7Y2FzZSAzOnJldHVybiJQcml2YXRlXyIrdGhpcy50YWcudGFnTnVtYmVyLnRvU3RyaW5nKCl9fSx0LnByb3RvdHlwZS5jb250ZW50PWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXRoaXMudGFnKXJldHVybiBudWxsO3ZvaWQgMD09PXQmJih0PTEvMCk7dmFyIGU9dGhpcy5wb3NDb250ZW50KCksaT1NYXRoLmFicyh0aGlzLmxlbmd0aCk7aWYoIXRoaXMudGFnLmlzVW5pdmVyc2FsKCkpcmV0dXJuIG51bGwhPT10aGlzLnN1Yj8iKCIrdGhpcy5zdWIubGVuZ3RoKyIgZWxlbSkiOnRoaXMuc3RyZWFtLnBhcnNlT2N0ZXRTdHJpbmcoZSxlK2ksdCk7c3dpdGNoKHRoaXMudGFnLnRhZ051bWJlcil7Y2FzZSAxOnJldHVybiAwPT09dGhpcy5zdHJlYW0uZ2V0KGUpPyJmYWxzZSI6InRydWUiO2Nhc2UgMjpyZXR1cm4gdGhpcy5zdHJlYW0ucGFyc2VJbnRlZ2VyKGUsZStpKTtjYXNlIDM6cmV0dXJuIHRoaXMuc3ViPyIoIit0aGlzLnN1Yi5sZW5ndGgrIiBlbGVtKSI6dGhpcy5zdHJlYW0ucGFyc2VCaXRTdHJpbmcoZSxlK2ksdCk7Y2FzZSA0OnJldHVybiB0aGlzLnN1Yj8iKCIrdGhpcy5zdWIubGVuZ3RoKyIgZWxlbSkiOnRoaXMuc3RyZWFtLnBhcnNlT2N0ZXRTdHJpbmcoZSxlK2ksdCk7Y2FzZSA2OnJldHVybiB0aGlzLnN0cmVhbS5wYXJzZU9JRChlLGUraSx0KTtjYXNlIDE2OmNhc2UgMTc6cmV0dXJuIG51bGwhPT10aGlzLnN1Yj8iKCIrdGhpcy5zdWIubGVuZ3RoKyIgZWxlbSkiOiIobm8gZWxlbSkiO2Nhc2UgMTI6cmV0dXJuIEUodGhpcy5zdHJlYW0ucGFyc2VTdHJpbmdVVEYoZSxlK2kpLHQpO2Nhc2UgMTg6Y2FzZSAxOTpjYXNlIDIwOmNhc2UgMjE6Y2FzZSAyMjpjYXNlIDI2OnJldHVybiBFKHRoaXMuc3RyZWFtLnBhcnNlU3RyaW5nSVNPKGUsZStpKSx0KTtjYXNlIDMwOnJldHVybiBFKHRoaXMuc3RyZWFtLnBhcnNlU3RyaW5nQk1QKGUsZStpKSx0KTtjYXNlIDIzOmNhc2UgMjQ6cmV0dXJuIHRoaXMuc3RyZWFtLnBhcnNlVGltZShlLGUraSwyMz09dGhpcy50YWcudGFnTnVtYmVyKX1yZXR1cm4gbnVsbH0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50eXBlTmFtZSgpKyJAIit0aGlzLnN0cmVhbS5wb3MrIltoZWFkZXI6Iit0aGlzLmhlYWRlcisiLGxlbmd0aDoiK3RoaXMubGVuZ3RoKyIsc3ViOiIrKG51bGw9PT10aGlzLnN1Yj8ibnVsbCI6dGhpcy5zdWIubGVuZ3RoKSsiXSJ9LHQucHJvdG90eXBlLnRvUHJldHR5U3RyaW5nPWZ1bmN0aW9uKHQpe3ZvaWQgMD09PXQmJih0PSIiKTt2YXIgZT10K3RoaXMudHlwZU5hbWUoKSsiIEAiK3RoaXMuc3RyZWFtLnBvcztpZih0aGlzLmxlbmd0aD49MCYmKGUrPSIrIiksZSs9dGhpcy5sZW5ndGgsdGhpcy50YWcudGFnQ29uc3RydWN0ZWQ/ZSs9IiAoY29uc3RydWN0ZWQpIjohdGhpcy50YWcuaXNVbml2ZXJzYWwoKXx8MyE9dGhpcy50YWcudGFnTnVtYmVyJiY0IT10aGlzLnRhZy50YWdOdW1iZXJ8fG51bGw9PT10aGlzLnN1Ynx8KGUrPSIgKGVuY2Fwc3VsYXRlcykiKSxlKz0iXG4iLG51bGwhPT10aGlzLnN1Yil7dCs9IiAgIjtmb3IodmFyIGk9MCxyPXRoaXMuc3ViLmxlbmd0aDtpPHI7KytpKWUrPXRoaXMuc3ViW2ldLnRvUHJldHR5U3RyaW5nKHQpfXJldHVybiBlfSx0LnByb3RvdHlwZS5wb3NTdGFydD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0cmVhbS5wb3N9LHQucHJvdG90eXBlLnBvc0NvbnRlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHJlYW0ucG9zK3RoaXMuaGVhZGVyfSx0LnByb3RvdHlwZS5wb3NFbmQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHJlYW0ucG9zK3RoaXMuaGVhZGVyK01hdGguYWJzKHRoaXMubGVuZ3RoKX0sdC5wcm90b3R5cGUudG9IZXhTdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHJlYW0uaGV4RHVtcCh0aGlzLnBvc1N0YXJ0KCksdGhpcy5wb3NFbmQoKSwhMCl9LHQuZGVjb2RlTGVuZ3RoPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZ2V0KCksaT0xMjcmZTtpZihpPT1lKXJldHVybiBpO2lmKGk+Nil0aHJvdyBuZXcgRXJyb3IoIkxlbmd0aCBvdmVyIDQ4IGJpdHMgbm90IHN1cHBvcnRlZCBhdCBwb3NpdGlvbiAiKyh0LnBvcy0xKSk7aWYoMD09PWkpcmV0dXJuIG51bGw7ZT0wO2Zvcih2YXIgcj0wO3I8aTsrK3IpZT0yNTYqZSt0LmdldCgpO3JldHVybiBlfSx0LnByb3RvdHlwZS5nZXRIZXhTdHJpbmdWYWx1ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMudG9IZXhTdHJpbmcoKSxlPTIqdGhpcy5oZWFkZXIsaT0yKnRoaXMubGVuZ3RoO3JldHVybiB0LnN1YnN0cihlLGkpfSx0LmRlY29kZT1mdW5jdGlvbihlKXt2YXIgaTtpPWUgaW5zdGFuY2VvZiBEP2U6bmV3IEQoZSwwKTt2YXIgcj1uZXcgRChpKSxuPW5ldyBSKGkpLHM9dC5kZWNvZGVMZW5ndGgoaSksbz1pLnBvcyxoPW8tci5wb3MsYT1udWxsLHU9ZnVuY3Rpb24oKXt2YXIgZT1bXTtpZihudWxsIT09cyl7Zm9yKHZhciByPW8rcztpLnBvczxyOyllW2UubGVuZ3RoXT10LmRlY29kZShpKTtpZihpLnBvcyE9cil0aHJvdyBuZXcgRXJyb3IoIkNvbnRlbnQgc2l6ZSBpcyBub3QgY29ycmVjdCBmb3IgY29udGFpbmVyIHN0YXJ0aW5nIGF0IG9mZnNldCAiK28pfWVsc2UgdHJ5e2Zvcig7Oyl7dmFyIG49dC5kZWNvZGUoaSk7aWYobi50YWcuaXNFT0MoKSlicmVhaztlW2UubGVuZ3RoXT1ufXM9by1pLnBvc31jYXRjaCh0KXt0aHJvdyBuZXcgRXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBkZWNvZGluZyB1bmRlZmluZWQgbGVuZ3RoIGNvbnRlbnQ6ICIrdCl9cmV0dXJuIGV9O2lmKG4udGFnQ29uc3RydWN0ZWQpYT11KCk7ZWxzZSBpZihuLmlzVW5pdmVyc2FsKCkmJigzPT1uLnRhZ051bWJlcnx8ND09bi50YWdOdW1iZXIpKXRyeXtpZigzPT1uLnRhZ051bWJlciYmMCE9aS5nZXQoKSl0aHJvdyBuZXcgRXJyb3IoIkJJVCBTVFJJTkdzIHdpdGggdW51c2VkIGJpdHMgY2Fubm90IGVuY2Fwc3VsYXRlLiIpO2E9dSgpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7KytjKWlmKGFbY10udGFnLmlzRU9DKCkpdGhyb3cgbmV3IEVycm9yKCJFT0MgaXMgbm90IHN1cHBvc2VkIHRvIGJlIGFjdHVhbCBjb250ZW50LiIpfWNhdGNoKHQpe2E9bnVsbH1pZihudWxsPT09YSl7aWYobnVsbD09PXMpdGhyb3cgbmV3IEVycm9yKCJXZSBjYW4ndCBza2lwIG92ZXIgYW4gaW52YWxpZCB0YWcgd2l0aCB1bmRlZmluZWQgbGVuZ3RoIGF0IG9mZnNldCAiK28pO2kucG9zPW8rTWF0aC5hYnMocyl9cmV0dXJuIG5ldyB0KHIsaCxzLG4sYSl9LHR9KCksUj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGU9dC5nZXQoKTtpZih0aGlzLnRhZ0NsYXNzPWU+PjYsdGhpcy50YWdDb25zdHJ1Y3RlZD0wIT0oMzImZSksdGhpcy50YWdOdW1iZXI9MzEmZSwzMT09dGhpcy50YWdOdW1iZXIpe3ZhciBpPW5ldyB5O2Rve2U9dC5nZXQoKSxpLm11bEFkZCgxMjgsMTI3JmUpfXdoaWxlKDEyOCZlKTt0aGlzLnRhZ051bWJlcj1pLnNpbXBsaWZ5KCl9fXJldHVybiB0LnByb3RvdHlwZS5pc1VuaXZlcnNhbD1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy50YWdDbGFzc30sdC5wcm90b3R5cGUuaXNFT0M9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMudGFnQ2xhc3MmJjA9PT10aGlzLnRhZ051bWJlcn0sdH0oKSxCPVsyLDMsNSw3LDExLDEzLDE3LDE5LDIzLDI5LDMxLDM3LDQxLDQzLDQ3LDUzLDU5LDYxLDY3LDcxLDczLDc5LDgzLDg5LDk3LDEwMSwxMDMsMTA3LDEwOSwxMTMsMTI3LDEzMSwxMzcsMTM5LDE0OSwxNTEsMTU3LDE2MywxNjcsMTczLDE3OSwxODEsMTkxLDE5MywxOTcsMTk5LDIxMSwyMjMsMjI3LDIyOSwyMzMsMjM5LDI0MSwyNTEsMjU3LDI2MywyNjksMjcxLDI3NywyODEsMjgzLDI5MywzMDcsMzExLDMxMywzMTcsMzMxLDMzNywzNDcsMzQ5LDM1MywzNTksMzY3LDM3MywzNzksMzgzLDM4OSwzOTcsNDAxLDQwOSw0MTksNDIxLDQzMSw0MzMsNDM5LDQ0Myw0NDksNDU3LDQ2MSw0NjMsNDY3LDQ3OSw0ODcsNDkxLDQ5OSw1MDMsNTA5LDUyMSw1MjMsNTQxLDU0Nyw1NTcsNTYzLDU2OSw1NzEsNTc3LDU4Nyw1OTMsNTk5LDYwMSw2MDcsNjEzLDYxNyw2MTksNjMxLDY0MSw2NDMsNjQ3LDY1Myw2NTksNjYxLDY3Myw2NzcsNjgzLDY5MSw3MDEsNzA5LDcxOSw3MjcsNzMzLDczOSw3NDMsNzUxLDc1Nyw3NjEsNzY5LDc3Myw3ODcsNzk3LDgwOSw4MTEsODIxLDgyMyw4MjcsODI5LDgzOSw4NTMsODU3LDg1OSw4NjMsODc3LDg4MSw4ODMsODg3LDkwNyw5MTEsOTE5LDkyOSw5MzcsOTQxLDk0Nyw5NTMsOTY3LDk3MSw5NzcsOTgzLDk5MSw5OTddLE89KDE8PDI2KS9CW0IubGVuZ3RoLTFdLEE9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpKXtudWxsIT10JiYoIm51bWJlciI9PXR5cGVvZiB0P3RoaXMuZnJvbU51bWJlcih0LGUsaSk6bnVsbD09ZSYmInN0cmluZyIhPXR5cGVvZiB0P3RoaXMuZnJvbVN0cmluZyh0LDI1Nik6dGhpcy5mcm9tU3RyaW5nKHQsZSkpfXJldHVybiB0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbih0KXtpZih0aGlzLnM8MClyZXR1cm4iLSIrdGhpcy5uZWdhdGUoKS50b1N0cmluZyh0KTt2YXIgaTtpZigxNj09dClpPTQ7ZWxzZSBpZig4PT10KWk9MztlbHNlIGlmKDI9PXQpaT0xO2Vsc2UgaWYoMzI9PXQpaT01O2Vsc2V7aWYoNCE9dClyZXR1cm4gdGhpcy50b1JhZGl4KHQpO2k9Mn12YXIgcixuPSgxPDxpKS0xLHM9ITEsbz0iIixoPXRoaXMudCxhPXRoaXMuREItaCp0aGlzLkRCJWk7aWYoaC0tID4wKWZvcihhPHRoaXMuREImJihyPXRoaXNbaF0+PmEpPjAmJihzPSEwLG89ZShyKSk7aD49MDspYTxpPyhyPSh0aGlzW2hdJigxPDxhKS0xKTw8aS1hLHJ8PXRoaXNbLS1oXT4+KGErPXRoaXMuREItaSkpOihyPXRoaXNbaF0+PihhLT1pKSZuLGE8PTAmJihhKz10aGlzLkRCLC0taCkpLHI+MCYmKHM9ITApLHMmJihvKz1lKHIpKTtyZXR1cm4gcz9vOiIwIn0sdC5wcm90b3R5cGUubmVnYXRlPWZ1bmN0aW9uKCl7dmFyIGU9TSgpO3JldHVybiB0LlpFUk8uc3ViVG8odGhpcyxlKSxlfSx0LnByb3RvdHlwZS5hYnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zPDA/dGhpcy5uZWdhdGUoKTp0aGlzfSx0LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5zLXQucztpZigwIT1lKXJldHVybiBlO3ZhciBpPXRoaXMudDtpZigwIT0oZT1pLXQudCkpcmV0dXJuIHRoaXMuczwwPy1lOmU7Zm9yKDstLWk+PTA7KWlmKDAhPShlPXRoaXNbaV0tdFtpXSkpcmV0dXJuIGU7cmV0dXJuIDB9LHQucHJvdG90eXBlLmJpdExlbmd0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnQ8PTA/MDp0aGlzLkRCKih0aGlzLnQtMSkrSyh0aGlzW3RoaXMudC0xXV50aGlzLnMmdGhpcy5ETSl9LHQucHJvdG90eXBlLm1vZD1mdW5jdGlvbihlKXt2YXIgaT1NKCk7cmV0dXJuIHRoaXMuYWJzKCkuZGl2UmVtVG8oZSxudWxsLGkpLHRoaXMuczwwJiZpLmNvbXBhcmVUbyh0LlpFUk8pPjAmJmUuc3ViVG8oaSxpKSxpfSx0LnByb3RvdHlwZS5tb2RQb3dJbnQ9ZnVuY3Rpb24odCxlKXt2YXIgaTtyZXR1cm4gaT10PDI1Nnx8ZS5pc0V2ZW4oKT9uZXcgSShlKTpuZXcgTihlKSx0aGlzLmV4cCh0LGkpfSx0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciB0PU0oKTtyZXR1cm4gdGhpcy5jb3B5VG8odCksdH0sdC5wcm90b3R5cGUuaW50VmFsdWU9ZnVuY3Rpb24oKXtpZih0aGlzLnM8MCl7aWYoMT09dGhpcy50KXJldHVybiB0aGlzWzBdLXRoaXMuRFY7aWYoMD09dGhpcy50KXJldHVybi0xfWVsc2V7aWYoMT09dGhpcy50KXJldHVybiB0aGlzWzBdO2lmKDA9PXRoaXMudClyZXR1cm4gMH1yZXR1cm4odGhpc1sxXSYoMTw8MzItdGhpcy5EQiktMSk8PHRoaXMuREJ8dGhpc1swXX0sdC5wcm90b3R5cGUuYnl0ZVZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMudD90aGlzLnM6dGhpc1swXTw8MjQ+PjI0fSx0LnByb3RvdHlwZS5zaG9ydFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMudD90aGlzLnM6dGhpc1swXTw8MTY+PjE2fSx0LnByb3RvdHlwZS5zaWdudW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zPDA/LTE6dGhpcy50PD0wfHwxPT10aGlzLnQmJnRoaXNbMF08PTA/MDoxfSx0LnByb3RvdHlwZS50b0J5dGVBcnJheT1mdW5jdGlvbigpe3ZhciB0PXRoaXMudCxlPVtdO2VbMF09dGhpcy5zO3ZhciBpLHI9dGhpcy5EQi10KnRoaXMuREIlOCxuPTA7aWYodC0tID4wKWZvcihyPHRoaXMuREImJihpPXRoaXNbdF0+PnIpIT0odGhpcy5zJnRoaXMuRE0pPj5yJiYoZVtuKytdPWl8dGhpcy5zPDx0aGlzLkRCLXIpO3Q+PTA7KXI8OD8oaT0odGhpc1t0XSYoMTw8ciktMSk8PDgtcixpfD10aGlzWy0tdF0+PihyKz10aGlzLkRCLTgpKTooaT10aGlzW3RdPj4oci09OCkmMjU1LHI8PTAmJihyKz10aGlzLkRCLC0tdCkpLDAhPSgxMjgmaSkmJihpfD0tMjU2KSwwPT1uJiYoMTI4JnRoaXMucykhPSgxMjgmaSkmJisrbiwobj4wfHxpIT10aGlzLnMpJiYoZVtuKytdPWkpO3JldHVybiBlfSx0LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24odCl7cmV0dXJuIDA9PXRoaXMuY29tcGFyZVRvKHQpfSx0LnByb3RvdHlwZS5taW49ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcGFyZVRvKHQpPDA/dGhpczp0fSx0LnByb3RvdHlwZS5tYXg9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcGFyZVRvKHQpPjA/dGhpczp0fSx0LnByb3RvdHlwZS5hbmQ9ZnVuY3Rpb24odCl7dmFyIGU9TSgpO3JldHVybiB0aGlzLmJpdHdpc2VUbyh0LG4sZSksZX0sdC5wcm90b3R5cGUub3I9ZnVuY3Rpb24odCl7dmFyIGU9TSgpO3JldHVybiB0aGlzLmJpdHdpc2VUbyh0LHMsZSksZX0sdC5wcm90b3R5cGUueG9yPWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5iaXR3aXNlVG8odCxvLGUpLGV9LHQucHJvdG90eXBlLmFuZE5vdD1mdW5jdGlvbih0KXt2YXIgZT1NKCk7cmV0dXJuIHRoaXMuYml0d2lzZVRvKHQsaCxlKSxlfSx0LnByb3RvdHlwZS5ub3Q9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9TSgpLGU9MDtlPHRoaXMudDsrK2UpdFtlXT10aGlzLkRNJn50aGlzW2VdO3JldHVybiB0LnQ9dGhpcy50LHQucz1+dGhpcy5zLHR9LHQucHJvdG90eXBlLnNoaWZ0TGVmdD1mdW5jdGlvbih0KXt2YXIgZT1NKCk7cmV0dXJuIHQ8MD90aGlzLnJTaGlmdFRvKC10LGUpOnRoaXMubFNoaWZ0VG8odCxlKSxlfSx0LnByb3RvdHlwZS5zaGlmdFJpZ2h0PWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdDwwP3RoaXMubFNoaWZ0VG8oLXQsZSk6dGhpcy5yU2hpZnRUbyh0LGUpLGV9LHQucHJvdG90eXBlLmdldExvd2VzdFNldEJpdD1mdW5jdGlvbigpe2Zvcih2YXIgdD0wO3Q8dGhpcy50OysrdClpZigwIT10aGlzW3RdKXJldHVybiB0KnRoaXMuREIrYSh0aGlzW3RdKTtyZXR1cm4gdGhpcy5zPDA/dGhpcy50KnRoaXMuREI6LTF9LHQucHJvdG90eXBlLmJpdENvdW50PWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAsZT10aGlzLnMmdGhpcy5ETSxpPTA7aTx0aGlzLnQ7KytpKXQrPXUodGhpc1tpXV5lKTtyZXR1cm4gdH0sdC5wcm90b3R5cGUudGVzdEJpdD1mdW5jdGlvbih0KXt2YXIgZT1NYXRoLmZsb29yKHQvdGhpcy5EQik7cmV0dXJuIGU+PXRoaXMudD8wIT10aGlzLnM6MCE9KHRoaXNbZV0mMTw8dCV0aGlzLkRCKX0sdC5wcm90b3R5cGUuc2V0Qml0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNoYW5nZUJpdCh0LHMpfSx0LnByb3RvdHlwZS5jbGVhckJpdD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jaGFuZ2VCaXQodCxoKX0sdC5wcm90b3R5cGUuZmxpcEJpdD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jaGFuZ2VCaXQodCxvKX0sdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5hZGRUbyh0LGUpLGV9LHQucHJvdG90eXBlLnN1YnRyYWN0PWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5zdWJUbyh0LGUpLGV9LHQucHJvdG90eXBlLm11bHRpcGx5PWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5tdWx0aXBseVRvKHQsZSksZX0sdC5wcm90b3R5cGUuZGl2aWRlPWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5kaXZSZW1Ubyh0LGUsbnVsbCksZX0sdC5wcm90b3R5cGUucmVtYWluZGVyPWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdGhpcy5kaXZSZW1Ubyh0LG51bGwsZSksZX0sdC5wcm90b3R5cGUuZGl2aWRlQW5kUmVtYWluZGVyPWZ1bmN0aW9uKHQpe3ZhciBlPU0oKSxpPU0oKTtyZXR1cm4gdGhpcy5kaXZSZW1Ubyh0LGUsaSksW2UsaV19LHQucHJvdG90eXBlLm1vZFBvdz1mdW5jdGlvbih0LGUpe3ZhciBpLHIsbj10LmJpdExlbmd0aCgpLHM9VSgxKTtpZihuPD0wKXJldHVybiBzO2k9bjwxOD8xOm48NDg/MzpuPDE0ND80Om48NzY4PzU6NixyPW48OD9uZXcgSShlKTplLmlzRXZlbigpP25ldyBQKGUpOm5ldyBOKGUpO3ZhciBvPVtdLGg9MyxhPWktMSx1PSgxPDxpKS0xO2lmKG9bMV09ci5jb252ZXJ0KHRoaXMpLGk+MSl7dmFyIGM9TSgpO2ZvcihyLnNxclRvKG9bMV0sYyk7aDw9dTspb1toXT1NKCksci5tdWxUbyhjLG9baC0yXSxvW2hdKSxoKz0yfXZhciBmLGwscD10LnQtMSxnPSEwLGQ9TSgpO2ZvcihuPUsodFtwXSktMTtwPj0wOyl7Zm9yKG4+PWE/Zj10W3BdPj5uLWEmdTooZj0odFtwXSYoMTw8bisxKS0xKTw8YS1uLHA+MCYmKGZ8PXRbcC0xXT4+dGhpcy5EQituLWEpKSxoPWk7MD09KDEmZik7KWY+Pj0xLC0taDtpZigobi09aCk8MCYmKG4rPXRoaXMuREIsLS1wKSxnKW9bZl0uY29weVRvKHMpLGc9ITE7ZWxzZXtmb3IoO2g+MTspci5zcXJUbyhzLGQpLHIuc3FyVG8oZCxzKSxoLT0yO2g+MD9yLnNxclRvKHMsZCk6KGw9cyxzPWQsZD1sKSxyLm11bFRvKGQsb1tmXSxzKX1mb3IoO3A+PTAmJjA9PSh0W3BdJjE8PG4pOylyLnNxclRvKHMsZCksbD1zLHM9ZCxkPWwsLS1uPDAmJihuPXRoaXMuREItMSwtLXApfXJldHVybiByLnJldmVydChzKX0sdC5wcm90b3R5cGUubW9kSW52ZXJzZT1mdW5jdGlvbihlKXt2YXIgaT1lLmlzRXZlbigpO2lmKHRoaXMuaXNFdmVuKCkmJml8fDA9PWUuc2lnbnVtKCkpcmV0dXJuIHQuWkVSTztmb3IodmFyIHI9ZS5jbG9uZSgpLG49dGhpcy5jbG9uZSgpLHM9VSgxKSxvPVUoMCksaD1VKDApLGE9VSgxKTswIT1yLnNpZ251bSgpOyl7Zm9yKDtyLmlzRXZlbigpOylyLnJTaGlmdFRvKDEsciksaT8ocy5pc0V2ZW4oKSYmby5pc0V2ZW4oKXx8KHMuYWRkVG8odGhpcyxzKSxvLnN1YlRvKGUsbykpLHMuclNoaWZ0VG8oMSxzKSk6by5pc0V2ZW4oKXx8by5zdWJUbyhlLG8pLG8uclNoaWZ0VG8oMSxvKTtmb3IoO24uaXNFdmVuKCk7KW4uclNoaWZ0VG8oMSxuKSxpPyhoLmlzRXZlbigpJiZhLmlzRXZlbigpfHwoaC5hZGRUbyh0aGlzLGgpLGEuc3ViVG8oZSxhKSksaC5yU2hpZnRUbygxLGgpKTphLmlzRXZlbigpfHxhLnN1YlRvKGUsYSksYS5yU2hpZnRUbygxLGEpO3IuY29tcGFyZVRvKG4pPj0wPyhyLnN1YlRvKG4sciksaSYmcy5zdWJUbyhoLHMpLG8uc3ViVG8oYSxvKSk6KG4uc3ViVG8ocixuKSxpJiZoLnN1YlRvKHMsaCksYS5zdWJUbyhvLGEpKX1yZXR1cm4gMCE9bi5jb21wYXJlVG8odC5PTkUpP3QuWkVSTzphLmNvbXBhcmVUbyhlKT49MD9hLnN1YnRyYWN0KGUpOmEuc2lnbnVtKCk8MD8oYS5hZGRUbyhlLGEpLGEuc2lnbnVtKCk8MD9hLmFkZChlKTphKTphfSx0LnByb3RvdHlwZS5wb3c9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZXhwKHQsbmV3IFYpfSx0LnByb3RvdHlwZS5nY2Q9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5zPDA/dGhpcy5uZWdhdGUoKTp0aGlzLmNsb25lKCksaT10LnM8MD90Lm5lZ2F0ZSgpOnQuY2xvbmUoKTtpZihlLmNvbXBhcmVUbyhpKTwwKXt2YXIgcj1lO2U9aSxpPXJ9dmFyIG49ZS5nZXRMb3dlc3RTZXRCaXQoKSxzPWkuZ2V0TG93ZXN0U2V0Qml0KCk7aWYoczwwKXJldHVybiBlO2ZvcihuPHMmJihzPW4pLHM+MCYmKGUuclNoaWZ0VG8ocyxlKSxpLnJTaGlmdFRvKHMsaSkpO2Uuc2lnbnVtKCk+MDspKG49ZS5nZXRMb3dlc3RTZXRCaXQoKSk+MCYmZS5yU2hpZnRUbyhuLGUpLChuPWkuZ2V0TG93ZXN0U2V0Qml0KCkpPjAmJmkuclNoaWZ0VG8obixpKSxlLmNvbXBhcmVUbyhpKT49MD8oZS5zdWJUbyhpLGUpLGUuclNoaWZ0VG8oMSxlKSk6KGkuc3ViVG8oZSxpKSxpLnJTaGlmdFRvKDEsaSkpO3JldHVybiBzPjAmJmkubFNoaWZ0VG8ocyxpKSxpfSx0LnByb3RvdHlwZS5pc1Byb2JhYmxlUHJpbWU9ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLmFicygpO2lmKDE9PWkudCYmaVswXTw9QltCLmxlbmd0aC0xXSl7Zm9yKGU9MDtlPEIubGVuZ3RoOysrZSlpZihpWzBdPT1CW2VdKXJldHVybiEwO3JldHVybiExfWlmKGkuaXNFdmVuKCkpcmV0dXJuITE7Zm9yKGU9MTtlPEIubGVuZ3RoOyl7Zm9yKHZhciByPUJbZV0sbj1lKzE7bjxCLmxlbmd0aCYmcjxPOylyKj1CW24rK107Zm9yKHI9aS5tb2RJbnQocik7ZTxuOylpZihyJUJbZSsrXT09MClyZXR1cm4hMX1yZXR1cm4gaS5taWxsZXJSYWJpbih0KX0sdC5wcm90b3R5cGUuY29weVRvPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLnQtMTtlPj0wOy0tZSl0W2VdPXRoaXNbZV07dC50PXRoaXMudCx0LnM9dGhpcy5zfSx0LnByb3RvdHlwZS5mcm9tSW50PWZ1bmN0aW9uKHQpe3RoaXMudD0xLHRoaXMucz10PDA/LTE6MCx0PjA/dGhpc1swXT10OnQ8LTE/dGhpc1swXT10K3RoaXMuRFY6dGhpcy50PTB9LHQucHJvdG90eXBlLmZyb21TdHJpbmc9ZnVuY3Rpb24oZSxpKXt2YXIgcjtpZigxNj09aSlyPTQ7ZWxzZSBpZig4PT1pKXI9MztlbHNlIGlmKDI1Nj09aSlyPTg7ZWxzZSBpZigyPT1pKXI9MTtlbHNlIGlmKDMyPT1pKXI9NTtlbHNle2lmKDQhPWkpcmV0dXJuIHZvaWQgdGhpcy5mcm9tUmFkaXgoZSxpKTtyPTJ9dGhpcy50PTAsdGhpcy5zPTA7Zm9yKHZhciBuPWUubGVuZ3RoLHM9ITEsbz0wOy0tbj49MDspe3ZhciBoPTg9PXI/MjU1JitlW25dOkYoZSxuKTtoPDA/Ii0iPT1lLmNoYXJBdChuKSYmKHM9ITApOihzPSExLDA9PW8/dGhpc1t0aGlzLnQrK109aDpvK3I+dGhpcy5EQj8odGhpc1t0aGlzLnQtMV18PShoJigxPDx0aGlzLkRCLW8pLTEpPDxvLHRoaXNbdGhpcy50KytdPWg+PnRoaXMuREItbyk6dGhpc1t0aGlzLnQtMV18PWg8PG8sKG8rPXIpPj10aGlzLkRCJiYoby09dGhpcy5EQikpfTg9PXImJjAhPSgxMjgmK2VbMF0pJiYodGhpcy5zPS0xLG8+MCYmKHRoaXNbdGhpcy50LTFdfD0oMTw8dGhpcy5EQi1vKS0xPDxvKSksdGhpcy5jbGFtcCgpLHMmJnQuWkVSTy5zdWJUbyh0aGlzLHRoaXMpfSx0LnByb3RvdHlwZS5jbGFtcD1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLnMmdGhpcy5ETTt0aGlzLnQ+MCYmdGhpc1t0aGlzLnQtMV09PXQ7KS0tdGhpcy50fSx0LnByb3RvdHlwZS5kbFNoaWZ0VG89ZnVuY3Rpb24odCxlKXt2YXIgaTtmb3IoaT10aGlzLnQtMTtpPj0wOy0taSllW2krdF09dGhpc1tpXTtmb3IoaT10LTE7aT49MDstLWkpZVtpXT0wO2UudD10aGlzLnQrdCxlLnM9dGhpcy5zfSx0LnByb3RvdHlwZS5kclNoaWZ0VG89ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dDtpPHRoaXMudDsrK2kpZVtpLXRdPXRoaXNbaV07ZS50PU1hdGgubWF4KHRoaXMudC10LDApLGUucz10aGlzLnN9LHQucHJvdG90eXBlLmxTaGlmdFRvPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPXQldGhpcy5EQixyPXRoaXMuREItaSxuPSgxPDxyKS0xLHM9TWF0aC5mbG9vcih0L3RoaXMuREIpLG89dGhpcy5zPDxpJnRoaXMuRE0saD10aGlzLnQtMTtoPj0wOy0taCllW2grcysxXT10aGlzW2hdPj5yfG8sbz0odGhpc1toXSZuKTw8aTtmb3IoaD1zLTE7aD49MDstLWgpZVtoXT0wO2Vbc109byxlLnQ9dGhpcy50K3MrMSxlLnM9dGhpcy5zLGUuY2xhbXAoKX0sdC5wcm90b3R5cGUuclNoaWZ0VG89ZnVuY3Rpb24odCxlKXtlLnM9dGhpcy5zO3ZhciBpPU1hdGguZmxvb3IodC90aGlzLkRCKTtpZihpPj10aGlzLnQpZS50PTA7ZWxzZXt2YXIgcj10JXRoaXMuREIsbj10aGlzLkRCLXIscz0oMTw8ciktMTtlWzBdPXRoaXNbaV0+PnI7Zm9yKHZhciBvPWkrMTtvPHRoaXMudDsrK28pZVtvLWktMV18PSh0aGlzW29dJnMpPDxuLGVbby1pXT10aGlzW29dPj5yO3I+MCYmKGVbdGhpcy50LWktMV18PSh0aGlzLnMmcyk8PG4pLGUudD10aGlzLnQtaSxlLmNsYW1wKCl9fSx0LnByb3RvdHlwZS5zdWJUbz1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9MCxuPU1hdGgubWluKHQudCx0aGlzLnQpO2k8bjspcis9dGhpc1tpXS10W2ldLGVbaSsrXT1yJnRoaXMuRE0scj4+PXRoaXMuREI7aWYodC50PHRoaXMudCl7Zm9yKHItPXQucztpPHRoaXMudDspcis9dGhpc1tpXSxlW2krK109ciZ0aGlzLkRNLHI+Pj10aGlzLkRCO3IrPXRoaXMuc31lbHNle2ZvcihyKz10aGlzLnM7aTx0LnQ7KXItPXRbaV0sZVtpKytdPXImdGhpcy5ETSxyPj49dGhpcy5EQjtyLT10LnN9ZS5zPXI8MD8tMTowLHI8LTE/ZVtpKytdPXRoaXMuRFYrcjpyPjAmJihlW2krK109ciksZS50PWksZS5jbGFtcCgpfSx0LnByb3RvdHlwZS5tdWx0aXBseVRvPWZ1bmN0aW9uKGUsaSl7dmFyIHI9dGhpcy5hYnMoKSxuPWUuYWJzKCkscz1yLnQ7Zm9yKGkudD1zK24udDstLXM+PTA7KWlbc109MDtmb3Iocz0wO3M8bi50OysrcylpW3Mrci50XT1yLmFtKDAsbltzXSxpLHMsMCxyLnQpO2kucz0wLGkuY2xhbXAoKSx0aGlzLnMhPWUucyYmdC5aRVJPLnN1YlRvKGksaSl9LHQucHJvdG90eXBlLnNxdWFyZVRvPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmFicygpLGk9dC50PTIqZS50Oy0taT49MDspdFtpXT0wO2ZvcihpPTA7aTxlLnQtMTsrK2kpe3ZhciByPWUuYW0oaSxlW2ldLHQsMippLDAsMSk7KHRbaStlLnRdKz1lLmFtKGkrMSwyKmVbaV0sdCwyKmkrMSxyLGUudC1pLTEpKT49ZS5EViYmKHRbaStlLnRdLT1lLkRWLHRbaStlLnQrMV09MSl9dC50PjAmJih0W3QudC0xXSs9ZS5hbShpLGVbaV0sdCwyKmksMCwxKSksdC5zPTAsdC5jbGFtcCgpfSx0LnByb3RvdHlwZS5kaXZSZW1Ubz1mdW5jdGlvbihlLGkscil7dmFyIG49ZS5hYnMoKTtpZighKG4udDw9MCkpe3ZhciBzPXRoaXMuYWJzKCk7aWYocy50PG4udClyZXR1cm4gbnVsbCE9aSYmaS5mcm9tSW50KDApLHZvaWQobnVsbCE9ciYmdGhpcy5jb3B5VG8ocikpO251bGw9PXImJihyPU0oKSk7dmFyIG89TSgpLGg9dGhpcy5zLGE9ZS5zLHU9dGhpcy5EQi1LKG5bbi50LTFdKTt1PjA/KG4ubFNoaWZ0VG8odSxvKSxzLmxTaGlmdFRvKHUscikpOihuLmNvcHlUbyhvKSxzLmNvcHlUbyhyKSk7dmFyIGM9by50LGY9b1tjLTFdO2lmKDAhPWYpe3ZhciBsPWYqKDE8PHRoaXMuRjEpKyhjPjE/b1tjLTJdPj50aGlzLkYyOjApLHA9dGhpcy5GVi9sLGc9KDE8PHRoaXMuRjEpL2wsZD0xPDx0aGlzLkYyLHY9ci50LG09di1jLHk9bnVsbD09aT9NKCk6aTtmb3Ioby5kbFNoaWZ0VG8obSx5KSxyLmNvbXBhcmVUbyh5KT49MCYmKHJbci50KytdPTEsci5zdWJUbyh5LHIpKSx0Lk9ORS5kbFNoaWZ0VG8oYyx5KSx5LnN1YlRvKG8sbyk7by50PGM7KW9bby50KytdPTA7Zm9yKDstLW0+PTA7KXt2YXIgYj1yWy0tdl09PWY/dGhpcy5ETTpNYXRoLmZsb29yKHJbdl0qcCsoclt2LTFdK2QpKmcpO2lmKChyW3ZdKz1vLmFtKDAsYixyLG0sMCxjKSk8Yilmb3Ioby5kbFNoaWZ0VG8obSx5KSxyLnN1YlRvKHkscik7clt2XTwtLWI7KXIuc3ViVG8oeSxyKX1udWxsIT1pJiYoci5kclNoaWZ0VG8oYyxpKSxoIT1hJiZ0LlpFUk8uc3ViVG8oaSxpKSksci50PWMsci5jbGFtcCgpLHU+MCYmci5yU2hpZnRUbyh1LHIpLGg8MCYmdC5aRVJPLnN1YlRvKHIscil9fX0sdC5wcm90b3R5cGUuaW52RGlnaXQ9ZnVuY3Rpb24oKXtpZih0aGlzLnQ8MSlyZXR1cm4gMDt2YXIgdD10aGlzWzBdO2lmKDA9PSgxJnQpKXJldHVybiAwO3ZhciBlPTMmdDtyZXR1cm4oZT0oZT0oZT0oZT1lKigyLSgxNSZ0KSplKSYxNSkqKDItKDI1NSZ0KSplKSYyNTUpKigyLSgoNjU1MzUmdCkqZSY2NTUzNSkpJjY1NTM1KSooMi10KmUldGhpcy5EVikldGhpcy5EVik+MD90aGlzLkRWLWU6LWV9LHQucHJvdG90eXBlLmlzRXZlbj1mdW5jdGlvbigpe3JldHVybiAwPT0odGhpcy50PjA/MSZ0aGlzWzBdOnRoaXMucyl9LHQucHJvdG90eXBlLmV4cD1mdW5jdGlvbihlLGkpe2lmKGU+NDI5NDk2NzI5NXx8ZTwxKXJldHVybiB0Lk9ORTt2YXIgcj1NKCksbj1NKCkscz1pLmNvbnZlcnQodGhpcyksbz1LKGUpLTE7Zm9yKHMuY29weVRvKHIpOy0tbz49MDspaWYoaS5zcXJUbyhyLG4pLChlJjE8PG8pPjApaS5tdWxUbyhuLHMscik7ZWxzZXt2YXIgaD1yO3I9bixuPWh9cmV0dXJuIGkucmV2ZXJ0KHIpfSx0LnByb3RvdHlwZS5jaHVua1NpemU9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5MTjIqdGhpcy5EQi9NYXRoLmxvZyh0KSl9LHQucHJvdG90eXBlLnRvUmFkaXg9ZnVuY3Rpb24odCl7aWYobnVsbD09dCYmKHQ9MTApLDA9PXRoaXMuc2lnbnVtKCl8fHQ8Mnx8dD4zNilyZXR1cm4iMCI7dmFyIGU9dGhpcy5jaHVua1NpemUodCksaT1NYXRoLnBvdyh0LGUpLHI9VShpKSxuPU0oKSxzPU0oKSxvPSIiO2Zvcih0aGlzLmRpdlJlbVRvKHIsbixzKTtuLnNpZ251bSgpPjA7KW89KGkrcy5pbnRWYWx1ZSgpKS50b1N0cmluZyh0KS5zdWJzdHIoMSkrbyxuLmRpdlJlbVRvKHIsbixzKTtyZXR1cm4gcy5pbnRWYWx1ZSgpLnRvU3RyaW5nKHQpK299LHQucHJvdG90eXBlLmZyb21SYWRpeD1mdW5jdGlvbihlLGkpe3RoaXMuZnJvbUludCgwKSxudWxsPT1pJiYoaT0xMCk7Zm9yKHZhciByPXRoaXMuY2h1bmtTaXplKGkpLG49TWF0aC5wb3coaSxyKSxzPSExLG89MCxoPTAsYT0wO2E8ZS5sZW5ndGg7KythKXt2YXIgdT1GKGUsYSk7dTwwPyItIj09ZS5jaGFyQXQoYSkmJjA9PXRoaXMuc2lnbnVtKCkmJihzPSEwKTooaD1pKmgrdSwrK28+PXImJih0aGlzLmRNdWx0aXBseShuKSx0aGlzLmRBZGRPZmZzZXQoaCwwKSxvPTAsaD0wKSl9bz4wJiYodGhpcy5kTXVsdGlwbHkoTWF0aC5wb3coaSxvKSksdGhpcy5kQWRkT2Zmc2V0KGgsMCkpLHMmJnQuWkVSTy5zdWJUbyh0aGlzLHRoaXMpfSx0LnByb3RvdHlwZS5mcm9tTnVtYmVyPWZ1bmN0aW9uKGUsaSxyKXtpZigibnVtYmVyIj09dHlwZW9mIGkpaWYoZTwyKXRoaXMuZnJvbUludCgxKTtlbHNlIGZvcih0aGlzLmZyb21OdW1iZXIoZSxyKSx0aGlzLnRlc3RCaXQoZS0xKXx8dGhpcy5iaXR3aXNlVG8odC5PTkUuc2hpZnRMZWZ0KGUtMSkscyx0aGlzKSx0aGlzLmlzRXZlbigpJiZ0aGlzLmRBZGRPZmZzZXQoMSwwKTshdGhpcy5pc1Byb2JhYmxlUHJpbWUoaSk7KXRoaXMuZEFkZE9mZnNldCgyLDApLHRoaXMuYml0TGVuZ3RoKCk+ZSYmdGhpcy5zdWJUbyh0Lk9ORS5zaGlmdExlZnQoZS0xKSx0aGlzKTtlbHNle3ZhciBuPVtdLG89NyZlO24ubGVuZ3RoPTErKGU+PjMpLGkubmV4dEJ5dGVzKG4pLG8+MD9uWzBdJj0oMTw8byktMTpuWzBdPTAsdGhpcy5mcm9tU3RyaW5nKG4sMjU2KX19LHQucHJvdG90eXBlLmJpdHdpc2VUbz1mdW5jdGlvbih0LGUsaSl7dmFyIHIsbixzPU1hdGgubWluKHQudCx0aGlzLnQpO2ZvcihyPTA7cjxzOysrcilpW3JdPWUodGhpc1tyXSx0W3JdKTtpZih0LnQ8dGhpcy50KXtmb3Iobj10LnMmdGhpcy5ETSxyPXM7cjx0aGlzLnQ7KytyKWlbcl09ZSh0aGlzW3JdLG4pO2kudD10aGlzLnR9ZWxzZXtmb3Iobj10aGlzLnMmdGhpcy5ETSxyPXM7cjx0LnQ7KytyKWlbcl09ZShuLHRbcl0pO2kudD10LnR9aS5zPWUodGhpcy5zLHQucyksaS5jbGFtcCgpfSx0LnByb3RvdHlwZS5jaGFuZ2VCaXQ9ZnVuY3Rpb24oZSxpKXt2YXIgcj10Lk9ORS5zaGlmdExlZnQoZSk7cmV0dXJuIHRoaXMuYml0d2lzZVRvKHIsaSxyKSxyfSx0LnByb3RvdHlwZS5hZGRUbz1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9MCxuPU1hdGgubWluKHQudCx0aGlzLnQpO2k8bjspcis9dGhpc1tpXSt0W2ldLGVbaSsrXT1yJnRoaXMuRE0scj4+PXRoaXMuREI7aWYodC50PHRoaXMudCl7Zm9yKHIrPXQucztpPHRoaXMudDspcis9dGhpc1tpXSxlW2krK109ciZ0aGlzLkRNLHI+Pj10aGlzLkRCO3IrPXRoaXMuc31lbHNle2ZvcihyKz10aGlzLnM7aTx0LnQ7KXIrPXRbaV0sZVtpKytdPXImdGhpcy5ETSxyPj49dGhpcy5EQjtyKz10LnN9ZS5zPXI8MD8tMTowLHI+MD9lW2krK109cjpyPC0xJiYoZVtpKytdPXRoaXMuRFYrciksZS50PWksZS5jbGFtcCgpfSx0LnByb3RvdHlwZS5kTXVsdGlwbHk9ZnVuY3Rpb24odCl7dGhpc1t0aGlzLnRdPXRoaXMuYW0oMCx0LTEsdGhpcywwLDAsdGhpcy50KSwrK3RoaXMudCx0aGlzLmNsYW1wKCl9LHQucHJvdG90eXBlLmRBZGRPZmZzZXQ9ZnVuY3Rpb24odCxlKXtpZigwIT10KXtmb3IoO3RoaXMudDw9ZTspdGhpc1t0aGlzLnQrK109MDtmb3IodGhpc1tlXSs9dDt0aGlzW2VdPj10aGlzLkRWOyl0aGlzW2VdLT10aGlzLkRWLCsrZT49dGhpcy50JiYodGhpc1t0aGlzLnQrK109MCksKyt0aGlzW2VdfX0sdC5wcm90b3R5cGUubXVsdGlwbHlMb3dlclRvPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1NYXRoLm1pbih0aGlzLnQrdC50LGUpO2ZvcihpLnM9MCxpLnQ9cjtyPjA7KWlbLS1yXT0wO2Zvcih2YXIgbj1pLnQtdGhpcy50O3I8bjsrK3IpaVtyK3RoaXMudF09dGhpcy5hbSgwLHRbcl0saSxyLDAsdGhpcy50KTtmb3Iobj1NYXRoLm1pbih0LnQsZSk7cjxuOysrcil0aGlzLmFtKDAsdFtyXSxpLHIsMCxlLXIpO2kuY2xhbXAoKX0sdC5wcm90b3R5cGUubXVsdGlwbHlVcHBlclRvPWZ1bmN0aW9uKHQsZSxpKXstLWU7dmFyIHI9aS50PXRoaXMudCt0LnQtZTtmb3IoaS5zPTA7LS1yPj0wOylpW3JdPTA7Zm9yKHI9TWF0aC5tYXgoZS10aGlzLnQsMCk7cjx0LnQ7KytyKWlbdGhpcy50K3ItZV09dGhpcy5hbShlLXIsdFtyXSxpLDAsMCx0aGlzLnQrci1lKTtpLmNsYW1wKCksaS5kclNoaWZ0VG8oMSxpKX0sdC5wcm90b3R5cGUubW9kSW50PWZ1bmN0aW9uKHQpe2lmKHQ8PTApcmV0dXJuIDA7dmFyIGU9dGhpcy5EViV0LGk9dGhpcy5zPDA/dC0xOjA7aWYodGhpcy50PjApaWYoMD09ZSlpPXRoaXNbMF0ldDtlbHNlIGZvcih2YXIgcj10aGlzLnQtMTtyPj0wOy0tcilpPShlKmkrdGhpc1tyXSkldDtyZXR1cm4gaX0sdC5wcm90b3R5cGUubWlsbGVyUmFiaW49ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5zdWJ0cmFjdCh0Lk9ORSkscj1pLmdldExvd2VzdFNldEJpdCgpO2lmKHI8PTApcmV0dXJuITE7dmFyIG49aS5zaGlmdFJpZ2h0KHIpOyhlPWUrMT4+MSk+Qi5sZW5ndGgmJihlPUIubGVuZ3RoKTtmb3IodmFyIHM9TSgpLG89MDtvPGU7KytvKXtzLmZyb21JbnQoQltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqQi5sZW5ndGgpXSk7dmFyIGg9cy5tb2RQb3cobix0aGlzKTtpZigwIT1oLmNvbXBhcmVUbyh0Lk9ORSkmJjAhPWguY29tcGFyZVRvKGkpKXtmb3IodmFyIGE9MTthKys8ciYmMCE9aC5jb21wYXJlVG8oaSk7KWlmKDA9PShoPWgubW9kUG93SW50KDIsdGhpcykpLmNvbXBhcmVUbyh0Lk9ORSkpcmV0dXJuITE7aWYoMCE9aC5jb21wYXJlVG8oaSkpcmV0dXJuITF9fXJldHVybiEwfSx0LnByb3RvdHlwZS5zcXVhcmU9ZnVuY3Rpb24oKXt2YXIgdD1NKCk7cmV0dXJuIHRoaXMuc3F1YXJlVG8odCksdH0sdC5wcm90b3R5cGUuZ2NkYT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuczwwP3RoaXMubmVnYXRlKCk6dGhpcy5jbG9uZSgpLHI9dC5zPDA/dC5uZWdhdGUoKTp0LmNsb25lKCk7aWYoaS5jb21wYXJlVG8ocik8MCl7dmFyIG49aTtpPXIscj1ufXZhciBzPWkuZ2V0TG93ZXN0U2V0Qml0KCksbz1yLmdldExvd2VzdFNldEJpdCgpO2lmKG88MCllKGkpO2Vsc2V7czxvJiYobz1zKSxvPjAmJihpLnJTaGlmdFRvKG8saSksci5yU2hpZnRUbyhvLHIpKTt2YXIgaD1mdW5jdGlvbigpeyhzPWkuZ2V0TG93ZXN0U2V0Qml0KCkpPjAmJmkuclNoaWZ0VG8ocyxpKSwocz1yLmdldExvd2VzdFNldEJpdCgpKT4wJiZyLnJTaGlmdFRvKHMsciksaS5jb21wYXJlVG8ocik+PTA/KGkuc3ViVG8ocixpKSxpLnJTaGlmdFRvKDEsaSkpOihyLnN1YlRvKGksciksci5yU2hpZnRUbygxLHIpKSxpLnNpZ251bSgpPjA/c2V0VGltZW91dChoLDApOihvPjAmJnIubFNoaWZ0VG8obyxyKSxzZXRUaW1lb3V0KChmdW5jdGlvbigpe2Uocil9KSwwKSl9O3NldFRpbWVvdXQoaCwxMCl9fSx0LnByb3RvdHlwZS5mcm9tTnVtYmVyQXN5bmM9ZnVuY3Rpb24oZSxpLHIsbil7aWYoIm51bWJlciI9PXR5cGVvZiBpKWlmKGU8Mil0aGlzLmZyb21JbnQoMSk7ZWxzZXt0aGlzLmZyb21OdW1iZXIoZSxyKSx0aGlzLnRlc3RCaXQoZS0xKXx8dGhpcy5iaXR3aXNlVG8odC5PTkUuc2hpZnRMZWZ0KGUtMSkscyx0aGlzKSx0aGlzLmlzRXZlbigpJiZ0aGlzLmRBZGRPZmZzZXQoMSwwKTt2YXIgbz10aGlzLGg9ZnVuY3Rpb24oKXtvLmRBZGRPZmZzZXQoMiwwKSxvLmJpdExlbmd0aCgpPmUmJm8uc3ViVG8odC5PTkUuc2hpZnRMZWZ0KGUtMSksbyksby5pc1Byb2JhYmxlUHJpbWUoaSk/c2V0VGltZW91dCgoZnVuY3Rpb24oKXtuKCl9KSwwKTpzZXRUaW1lb3V0KGgsMCl9O3NldFRpbWVvdXQoaCwwKX1lbHNle3ZhciBhPVtdLHU9NyZlO2EubGVuZ3RoPTErKGU+PjMpLGkubmV4dEJ5dGVzKGEpLHU+MD9hWzBdJj0oMTw8dSktMTphWzBdPTAsdGhpcy5mcm9tU3RyaW5nKGEsMjU2KX19LHR9KCksVj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQucHJvdG90eXBlLmNvbnZlcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHQucHJvdG90eXBlLnJldmVydD1mdW5jdGlvbih0KXtyZXR1cm4gdH0sdC5wcm90b3R5cGUubXVsVG89ZnVuY3Rpb24odCxlLGkpe3QubXVsdGlwbHlUbyhlLGkpfSx0LnByb3RvdHlwZS5zcXJUbz1mdW5jdGlvbih0LGUpe3Quc3F1YXJlVG8oZSl9LHR9KCksST1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5tPXR9cmV0dXJuIHQucHJvdG90eXBlLmNvbnZlcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHQuczwwfHx0LmNvbXBhcmVUbyh0aGlzLm0pPj0wP3QubW9kKHRoaXMubSk6dH0sdC5wcm90b3R5cGUucmV2ZXJ0PWZ1bmN0aW9uKHQpe3JldHVybiB0fSx0LnByb3RvdHlwZS5yZWR1Y2U9ZnVuY3Rpb24odCl7dC5kaXZSZW1Ubyh0aGlzLm0sbnVsbCx0KX0sdC5wcm90b3R5cGUubXVsVG89ZnVuY3Rpb24odCxlLGkpe3QubXVsdGlwbHlUbyhlLGkpLHRoaXMucmVkdWNlKGkpfSx0LnByb3RvdHlwZS5zcXJUbz1mdW5jdGlvbih0LGUpe3Quc3F1YXJlVG8oZSksdGhpcy5yZWR1Y2UoZSl9LHR9KCksTj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5tPXQsdGhpcy5tcD10LmludkRpZ2l0KCksdGhpcy5tcGw9MzI3NjcmdGhpcy5tcCx0aGlzLm1waD10aGlzLm1wPj4xNSx0aGlzLnVtPSgxPDx0LkRCLTE1KS0xLHRoaXMubXQyPTIqdC50fXJldHVybiB0LnByb3RvdHlwZS5jb252ZXJ0PWZ1bmN0aW9uKHQpe3ZhciBlPU0oKTtyZXR1cm4gdC5hYnMoKS5kbFNoaWZ0VG8odGhpcy5tLnQsZSksZS5kaXZSZW1Ubyh0aGlzLm0sbnVsbCxlKSx0LnM8MCYmZS5jb21wYXJlVG8oQS5aRVJPKT4wJiZ0aGlzLm0uc3ViVG8oZSxlKSxlfSx0LnByb3RvdHlwZS5yZXZlcnQ9ZnVuY3Rpb24odCl7dmFyIGU9TSgpO3JldHVybiB0LmNvcHlUbyhlKSx0aGlzLnJlZHVjZShlKSxlfSx0LnByb3RvdHlwZS5yZWR1Y2U9ZnVuY3Rpb24odCl7Zm9yKDt0LnQ8PXRoaXMubXQyOyl0W3QudCsrXT0wO2Zvcih2YXIgZT0wO2U8dGhpcy5tLnQ7KytlKXt2YXIgaT0zMjc2NyZ0W2VdLHI9aSp0aGlzLm1wbCsoKGkqdGhpcy5tcGgrKHRbZV0+PjE1KSp0aGlzLm1wbCZ0aGlzLnVtKTw8MTUpJnQuRE07Zm9yKHRbaT1lK3RoaXMubS50XSs9dGhpcy5tLmFtKDAscix0LGUsMCx0aGlzLm0udCk7dFtpXT49dC5EVjspdFtpXS09dC5EVix0WysraV0rK310LmNsYW1wKCksdC5kclNoaWZ0VG8odGhpcy5tLnQsdCksdC5jb21wYXJlVG8odGhpcy5tKT49MCYmdC5zdWJUbyh0aGlzLm0sdCl9LHQucHJvdG90eXBlLm11bFRvPWZ1bmN0aW9uKHQsZSxpKXt0Lm11bHRpcGx5VG8oZSxpKSx0aGlzLnJlZHVjZShpKX0sdC5wcm90b3R5cGUuc3FyVG89ZnVuY3Rpb24odCxlKXt0LnNxdWFyZVRvKGUpLHRoaXMucmVkdWNlKGUpfSx0fSgpLFA9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMubT10LHRoaXMucjI9TSgpLHRoaXMucTM9TSgpLEEuT05FLmRsU2hpZnRUbygyKnQudCx0aGlzLnIyKSx0aGlzLm11PXRoaXMucjIuZGl2aWRlKHQpfXJldHVybiB0LnByb3RvdHlwZS5jb252ZXJ0PWZ1bmN0aW9uKHQpe2lmKHQuczwwfHx0LnQ+Mip0aGlzLm0udClyZXR1cm4gdC5tb2QodGhpcy5tKTtpZih0LmNvbXBhcmVUbyh0aGlzLm0pPDApcmV0dXJuIHQ7dmFyIGU9TSgpO3JldHVybiB0LmNvcHlUbyhlKSx0aGlzLnJlZHVjZShlKSxlfSx0LnByb3RvdHlwZS5yZXZlcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHQucHJvdG90eXBlLnJlZHVjZT1mdW5jdGlvbih0KXtmb3IodC5kclNoaWZ0VG8odGhpcy5tLnQtMSx0aGlzLnIyKSx0LnQ+dGhpcy5tLnQrMSYmKHQudD10aGlzLm0udCsxLHQuY2xhbXAoKSksdGhpcy5tdS5tdWx0aXBseVVwcGVyVG8odGhpcy5yMix0aGlzLm0udCsxLHRoaXMucTMpLHRoaXMubS5tdWx0aXBseUxvd2VyVG8odGhpcy5xMyx0aGlzLm0udCsxLHRoaXMucjIpO3QuY29tcGFyZVRvKHRoaXMucjIpPDA7KXQuZEFkZE9mZnNldCgxLHRoaXMubS50KzEpO2Zvcih0LnN1YlRvKHRoaXMucjIsdCk7dC5jb21wYXJlVG8odGhpcy5tKT49MDspdC5zdWJUbyh0aGlzLm0sdCl9LHQucHJvdG90eXBlLm11bFRvPWZ1bmN0aW9uKHQsZSxpKXt0Lm11bHRpcGx5VG8oZSxpKSx0aGlzLnJlZHVjZShpKX0sdC5wcm90b3R5cGUuc3FyVG89ZnVuY3Rpb24odCxlKXt0LnNxdWFyZVRvKGUpLHRoaXMucmVkdWNlKGUpfSx0fSgpO2Z1bmN0aW9uIE0oKXtyZXR1cm4gbmV3IEEobnVsbCl9ZnVuY3Rpb24gTCh0LGUpe3JldHVybiBuZXcgQSh0LGUpfXZhciBqPSJ1bmRlZmluZWQiIT10eXBlb2YgbmF2aWdhdG9yO2omJiJNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIiPT1uYXZpZ2F0b3IuYXBwTmFtZT8oQS5wcm90b3R5cGUuYW09ZnVuY3Rpb24odCxlLGkscixuLHMpe2Zvcih2YXIgbz0zMjc2NyZlLGg9ZT4+MTU7LS1zPj0wOyl7dmFyIGE9MzI3NjcmdGhpc1t0XSx1PXRoaXNbdCsrXT4+MTUsYz1oKmErdSpvO249KChhPW8qYSsoKDMyNzY3JmMpPDwxNSkraVtyXSsoMTA3Mzc0MTgyMyZuKSk+Pj4zMCkrKGM+Pj4xNSkraCp1KyhuPj4+MzApLGlbcisrXT0xMDczNzQxODIzJmF9cmV0dXJuIG59LHc9MzApOmomJiJOZXRzY2FwZSIhPW5hdmlnYXRvci5hcHBOYW1lPyhBLnByb3RvdHlwZS5hbT1mdW5jdGlvbih0LGUsaSxyLG4scyl7Zm9yKDstLXM+PTA7KXt2YXIgbz1lKnRoaXNbdCsrXStpW3JdK247bj1NYXRoLmZsb29yKG8vNjcxMDg4NjQpLGlbcisrXT02NzEwODg2MyZvfXJldHVybiBufSx3PTI2KTooQS5wcm90b3R5cGUuYW09ZnVuY3Rpb24odCxlLGkscixuLHMpe2Zvcih2YXIgbz0xNjM4MyZlLGg9ZT4+MTQ7LS1zPj0wOyl7dmFyIGE9MTYzODMmdGhpc1t0XSx1PXRoaXNbdCsrXT4+MTQsYz1oKmErdSpvO249KChhPW8qYSsoKDE2MzgzJmMpPDwxNCkraVtyXStuKT4+MjgpKyhjPj4xNCkraCp1LGlbcisrXT0yNjg0MzU0NTUmYX1yZXR1cm4gbn0sdz0yOCksQS5wcm90b3R5cGUuREI9dyxBLnByb3RvdHlwZS5ETT0oMTw8dyktMSxBLnByb3RvdHlwZS5EVj0xPDx3LEEucHJvdG90eXBlLkZWPU1hdGgucG93KDIsNTIpLEEucHJvdG90eXBlLkYxPTUyLXcsQS5wcm90b3R5cGUuRjI9Mip3LTUyO3ZhciBxLEgsQz1bXTtmb3IocT0iMCIuY2hhckNvZGVBdCgwKSxIPTA7SDw9OTsrK0gpQ1txKytdPUg7Zm9yKHE9ImEiLmNoYXJDb2RlQXQoMCksSD0xMDtIPDM2OysrSClDW3ErK109SDtmb3IocT0iQSIuY2hhckNvZGVBdCgwKSxIPTEwO0g8MzY7KytIKUNbcSsrXT1IO2Z1bmN0aW9uIEYodCxlKXt2YXIgaT1DW3QuY2hhckNvZGVBdChlKV07cmV0dXJuIG51bGw9PWk/LTE6aX1mdW5jdGlvbiBVKHQpe3ZhciBlPU0oKTtyZXR1cm4gZS5mcm9tSW50KHQpLGV9ZnVuY3Rpb24gSyh0KXt2YXIgZSxpPTE7cmV0dXJuIDAhPShlPXQ+Pj4xNikmJih0PWUsaSs9MTYpLDAhPShlPXQ+PjgpJiYodD1lLGkrPTgpLDAhPShlPXQ+PjQpJiYodD1lLGkrPTQpLDAhPShlPXQ+PjIpJiYodD1lLGkrPTIpLDAhPShlPXQ+PjEpJiYodD1lLGkrPTEpLGl9QS5aRVJPPVUoMCksQS5PTkU9VSgxKTt2YXIgayxfLHo9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5pPTAsdGhpcy5qPTAsdGhpcy5TPVtdfXJldHVybiB0LnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKHQpe3ZhciBlLGkscjtmb3IoZT0wO2U8MjU2OysrZSl0aGlzLlNbZV09ZTtmb3IoaT0wLGU9MDtlPDI1NjsrK2UpaT1pK3RoaXMuU1tlXSt0W2UldC5sZW5ndGhdJjI1NSxyPXRoaXMuU1tlXSx0aGlzLlNbZV09dGhpcy5TW2ldLHRoaXMuU1tpXT1yO3RoaXMuaT0wLHRoaXMuaj0wfSx0LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMuaT10aGlzLmkrMSYyNTUsdGhpcy5qPXRoaXMuait0aGlzLlNbdGhpcy5pXSYyNTUsdD10aGlzLlNbdGhpcy5pXSx0aGlzLlNbdGhpcy5pXT10aGlzLlNbdGhpcy5qXSx0aGlzLlNbdGhpcy5qXT10LHRoaXMuU1t0K3RoaXMuU1t0aGlzLmldJjI1NV19LHR9KCksWj0yNTYsRz1udWxsO2lmKG51bGw9PUcpe0c9W10sXz0wO3ZhciAkPXZvaWQgMDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93LmNyeXB0byYmd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMpe3ZhciBZPW5ldyBVaW50MzJBcnJheSgyNTYpO2Zvcih3aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhZKSwkPTA7JDxZLmxlbmd0aDsrKyQpR1tfKytdPTI1NSZZWyRdfXZhciBKPTAsWD1mdW5jdGlvbih0KXtpZigoSj1KfHwwKT49MjU2fHxfPj1aKXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyP3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLFgsITEpOndpbmRvdy5kZXRhY2hFdmVudCYmd2luZG93LmRldGFjaEV2ZW50KCJvbm1vdXNlbW92ZSIsWCk7ZWxzZSB0cnl7dmFyIGU9dC54K3QueTtHW18rK109MjU1JmUsSis9MX1jYXRjaCh0KXt9fTsidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyP3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLFgsITEpOndpbmRvdy5hdHRhY2hFdmVudCYmd2luZG93LmF0dGFjaEV2ZW50KCJvbm1vdXNlbW92ZSIsWCkpfWZ1bmN0aW9uIFEoKXtpZihudWxsPT1rKXtmb3Ioaz1uZXcgejtfPFo7KXt2YXIgdD1NYXRoLmZsb29yKDY1NTM2Kk1hdGgucmFuZG9tKCkpO0dbXysrXT0yNTUmdH1mb3Ioay5pbml0KEcpLF89MDtfPEcubGVuZ3RoOysrXylHW19dPTA7Xz0wfXJldHVybiBrLm5leHQoKX12YXIgVz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIHQucHJvdG90eXBlLm5leHRCeXRlcz1mdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHQubGVuZ3RoOysrZSl0W2VdPVEoKX0sdH0oKSx0dD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt0aGlzLm49bnVsbCx0aGlzLmU9MCx0aGlzLmQ9bnVsbCx0aGlzLnA9bnVsbCx0aGlzLnE9bnVsbCx0aGlzLmRtcDE9bnVsbCx0aGlzLmRtcTE9bnVsbCx0aGlzLmNvZWZmPW51bGx9cmV0dXJuIHQucHJvdG90eXBlLmRvUHVibGljPWZ1bmN0aW9uKHQpe3JldHVybiB0Lm1vZFBvd0ludCh0aGlzLmUsdGhpcy5uKX0sdC5wcm90b3R5cGUuZG9Qcml2YXRlPWZ1bmN0aW9uKHQpe2lmKG51bGw9PXRoaXMucHx8bnVsbD09dGhpcy5xKXJldHVybiB0Lm1vZFBvdyh0aGlzLmQsdGhpcy5uKTtmb3IodmFyIGU9dC5tb2QodGhpcy5wKS5tb2RQb3codGhpcy5kbXAxLHRoaXMucCksaT10Lm1vZCh0aGlzLnEpLm1vZFBvdyh0aGlzLmRtcTEsdGhpcy5xKTtlLmNvbXBhcmVUbyhpKTwwOyllPWUuYWRkKHRoaXMucCk7cmV0dXJuIGUuc3VidHJhY3QoaSkubXVsdGlwbHkodGhpcy5jb2VmZikubW9kKHRoaXMucCkubXVsdGlwbHkodGhpcy5xKS5hZGQoaSl9LHQucHJvdG90eXBlLnNldFB1YmxpYz1mdW5jdGlvbih0LGUpe251bGwhPXQmJm51bGwhPWUmJnQubGVuZ3RoPjAmJmUubGVuZ3RoPjA/KHRoaXMubj1MKHQsMTYpLHRoaXMuZT1wYXJzZUludChlLDE2KSk6Y29uc29sZS5lcnJvcigiSW52YWxpZCBSU0EgcHVibGljIGtleSIpfSx0LnByb3RvdHlwZS5lbmNyeXB0PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMubi5iaXRMZW5ndGgoKSs3Pj4zLGk9ZnVuY3Rpb24odCxlKXtpZihlPHQubGVuZ3RoKzExKXJldHVybiBjb25zb2xlLmVycm9yKCJNZXNzYWdlIHRvbyBsb25nIGZvciBSU0EiKSxudWxsO2Zvcih2YXIgaT1bXSxyPXQubGVuZ3RoLTE7cj49MCYmZT4wOyl7dmFyIG49dC5jaGFyQ29kZUF0KHItLSk7bjwxMjg/aVstLWVdPW46bj4xMjcmJm48MjA0OD8oaVstLWVdPTYzJm58MTI4LGlbLS1lXT1uPj42fDE5Mik6KGlbLS1lXT02MyZufDEyOCxpWy0tZV09bj4+NiY2M3wxMjgsaVstLWVdPW4+PjEyfDIyNCl9aVstLWVdPTA7Zm9yKHZhciBzPW5ldyBXLG89W107ZT4yOyl7Zm9yKG9bMF09MDswPT1vWzBdOylzLm5leHRCeXRlcyhvKTtpWy0tZV09b1swXX1yZXR1cm4gaVstLWVdPTIsaVstLWVdPTAsbmV3IEEoaSl9KHQsZSk7aWYobnVsbD09aSlyZXR1cm4gbnVsbDt2YXIgcj10aGlzLmRvUHVibGljKGkpO2lmKG51bGw9PXIpcmV0dXJuIG51bGw7Zm9yKHZhciBuPXIudG9TdHJpbmcoMTYpLHM9bi5sZW5ndGgsbz0wO288MiplLXM7bysrKW49IjAiK247cmV0dXJuIG59LHQucHJvdG90eXBlLnNldFByaXZhdGU9ZnVuY3Rpb24odCxlLGkpe251bGwhPXQmJm51bGwhPWUmJnQubGVuZ3RoPjAmJmUubGVuZ3RoPjA/KHRoaXMubj1MKHQsMTYpLHRoaXMuZT1wYXJzZUludChlLDE2KSx0aGlzLmQ9TChpLDE2KSk6Y29uc29sZS5lcnJvcigiSW52YWxpZCBSU0EgcHJpdmF0ZSBrZXkiKX0sdC5wcm90b3R5cGUuc2V0UHJpdmF0ZUV4PWZ1bmN0aW9uKHQsZSxpLHIsbixzLG8saCl7bnVsbCE9dCYmbnVsbCE9ZSYmdC5sZW5ndGg+MCYmZS5sZW5ndGg+MD8odGhpcy5uPUwodCwxNiksdGhpcy5lPXBhcnNlSW50KGUsMTYpLHRoaXMuZD1MKGksMTYpLHRoaXMucD1MKHIsMTYpLHRoaXMucT1MKG4sMTYpLHRoaXMuZG1wMT1MKHMsMTYpLHRoaXMuZG1xMT1MKG8sMTYpLHRoaXMuY29lZmY9TChoLDE2KSk6Y29uc29sZS5lcnJvcigiSW52YWxpZCBSU0EgcHJpdmF0ZSBrZXkiKX0sdC5wcm90b3R5cGUuZ2VuZXJhdGU9ZnVuY3Rpb24odCxlKXt2YXIgaT1uZXcgVyxyPXQ+PjE7dGhpcy5lPXBhcnNlSW50KGUsMTYpO2Zvcih2YXIgbj1uZXcgQShlLDE2KTs7KXtmb3IoO3RoaXMucD1uZXcgQSh0LXIsMSxpKSwwIT10aGlzLnAuc3VidHJhY3QoQS5PTkUpLmdjZChuKS5jb21wYXJlVG8oQS5PTkUpfHwhdGhpcy5wLmlzUHJvYmFibGVQcmltZSgxMCk7KTtmb3IoO3RoaXMucT1uZXcgQShyLDEsaSksMCE9dGhpcy5xLnN1YnRyYWN0KEEuT05FKS5nY2QobikuY29tcGFyZVRvKEEuT05FKXx8IXRoaXMucS5pc1Byb2JhYmxlUHJpbWUoMTApOyk7aWYodGhpcy5wLmNvbXBhcmVUbyh0aGlzLnEpPD0wKXt2YXIgcz10aGlzLnA7dGhpcy5wPXRoaXMucSx0aGlzLnE9c312YXIgbz10aGlzLnAuc3VidHJhY3QoQS5PTkUpLGg9dGhpcy5xLnN1YnRyYWN0KEEuT05FKSxhPW8ubXVsdGlwbHkoaCk7aWYoMD09YS5nY2QobikuY29tcGFyZVRvKEEuT05FKSl7dGhpcy5uPXRoaXMucC5tdWx0aXBseSh0aGlzLnEpLHRoaXMuZD1uLm1vZEludmVyc2UoYSksdGhpcy5kbXAxPXRoaXMuZC5tb2QobyksdGhpcy5kbXExPXRoaXMuZC5tb2QoaCksdGhpcy5jb2VmZj10aGlzLnEubW9kSW52ZXJzZSh0aGlzLnApO2JyZWFrfX19LHQucHJvdG90eXBlLmRlY3J5cHQ9ZnVuY3Rpb24odCl7dmFyIGU9TCh0LDE2KSxpPXRoaXMuZG9Qcml2YXRlKGUpO3JldHVybiBudWxsPT1pP251bGw6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dC50b0J5dGVBcnJheSgpLHI9MDtyPGkubGVuZ3RoJiYwPT1pW3JdOykrK3I7aWYoaS5sZW5ndGgtciE9ZS0xfHwyIT1pW3JdKXJldHVybiBudWxsO2ZvcigrK3I7MCE9aVtyXTspaWYoKytyPj1pLmxlbmd0aClyZXR1cm4gbnVsbDtmb3IodmFyIG49IiI7KytyPGkubGVuZ3RoOyl7dmFyIHM9MjU1Jmlbcl07czwxMjg/bis9U3RyaW5nLmZyb21DaGFyQ29kZShzKTpzPjE5MSYmczwyMjQ/KG4rPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJnMpPDw2fDYzJmlbcisxXSksKytyKToobis9U3RyaW5nLmZyb21DaGFyQ29kZSgoMTUmcyk8PDEyfCg2MyZpW3IrMV0pPDw2fDYzJmlbcisyXSkscis9Mil9cmV0dXJuIG59KGksdGhpcy5uLmJpdExlbmd0aCgpKzc+PjMpfSx0LnByb3RvdHlwZS5nZW5lcmF0ZUFzeW5jPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1uZXcgVyxuPXQ+PjE7dGhpcy5lPXBhcnNlSW50KGUsMTYpO3ZhciBzPW5ldyBBKGUsMTYpLG89dGhpcyxoPWZ1bmN0aW9uKCl7dmFyIGU9ZnVuY3Rpb24oKXtpZihvLnAuY29tcGFyZVRvKG8ucSk8PTApe3ZhciB0PW8ucDtvLnA9by5xLG8ucT10fXZhciBlPW8ucC5zdWJ0cmFjdChBLk9ORSkscj1vLnEuc3VidHJhY3QoQS5PTkUpLG49ZS5tdWx0aXBseShyKTswPT1uLmdjZChzKS5jb21wYXJlVG8oQS5PTkUpPyhvLm49by5wLm11bHRpcGx5KG8ucSksby5kPXMubW9kSW52ZXJzZShuKSxvLmRtcDE9by5kLm1vZChlKSxvLmRtcTE9by5kLm1vZChyKSxvLmNvZWZmPW8ucS5tb2RJbnZlcnNlKG8ucCksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtpKCl9KSwwKSk6c2V0VGltZW91dChoLDApfSxhPWZ1bmN0aW9uKCl7by5xPU0oKSxvLnEuZnJvbU51bWJlckFzeW5jKG4sMSxyLChmdW5jdGlvbigpe28ucS5zdWJ0cmFjdChBLk9ORSkuZ2NkYShzLChmdW5jdGlvbih0KXswPT10LmNvbXBhcmVUbyhBLk9ORSkmJm8ucS5pc1Byb2JhYmxlUHJpbWUoMTApP3NldFRpbWVvdXQoZSwwKTpzZXRUaW1lb3V0KGEsMCl9KSl9KSl9LHU9ZnVuY3Rpb24oKXtvLnA9TSgpLG8ucC5mcm9tTnVtYmVyQXN5bmModC1uLDEsciwoZnVuY3Rpb24oKXtvLnAuc3VidHJhY3QoQS5PTkUpLmdjZGEocywoZnVuY3Rpb24odCl7MD09dC5jb21wYXJlVG8oQS5PTkUpJiZvLnAuaXNQcm9iYWJsZVByaW1lKDEwKT9zZXRUaW1lb3V0KGEsMCk6c2V0VGltZW91dCh1LDApfSkpfSkpfTtzZXRUaW1lb3V0KHUsMCl9O3NldFRpbWVvdXQoaCwwKX0sdC5wcm90b3R5cGUuc2lnbj1mdW5jdGlvbih0LGUsaSl7dmFyIHI9ZnVuY3Rpb24odCxlKXtpZihlPHQubGVuZ3RoKzIyKXJldHVybiBjb25zb2xlLmVycm9yKCJNZXNzYWdlIHRvbyBsb25nIGZvciBSU0EiKSxudWxsO2Zvcih2YXIgaT1lLXQubGVuZ3RoLTYscj0iIixuPTA7bjxpO24rPTIpcis9ImZmIjtyZXR1cm4gTCgiMDAwMSIrcisiMDAiK3QsMTYpfSgoZXRbaV18fCIiKStlKHQpLnRvU3RyaW5nKCksdGhpcy5uLmJpdExlbmd0aCgpLzQpO2lmKG51bGw9PXIpcmV0dXJuIG51bGw7dmFyIG49dGhpcy5kb1ByaXZhdGUocik7aWYobnVsbD09bilyZXR1cm4gbnVsbDt2YXIgcz1uLnRvU3RyaW5nKDE2KTtyZXR1cm4gMD09KDEmcy5sZW5ndGgpP3M6IjAiK3N9LHQucHJvdG90eXBlLnZlcmlmeT1mdW5jdGlvbih0LGUsaSl7dmFyIHI9TChlLDE2KSxuPXRoaXMuZG9QdWJsaWMocik7cmV0dXJuIG51bGw9PW4/bnVsbDpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gZXQpaWYoZXQuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBpPWV0W2VdLHI9aS5sZW5ndGg7aWYodC5zdWJzdHIoMCxyKT09aSlyZXR1cm4gdC5zdWJzdHIocil9cmV0dXJuIHR9KG4udG9TdHJpbmcoMTYpLnJlcGxhY2UoL14xZiswMC8sIiIpKT09aSh0KS50b1N0cmluZygpfSx0fSgpLGV0PXttZDI6IjMwMjAzMDBjMDYwODJhODY0ODg2ZjcwZDAyMDIwNTAwMDQxMCIsbWQ1OiIzMDIwMzAwYzA2MDgyYTg2NDg4NmY3MGQwMjA1MDUwMDA0MTAiLHNoYTE6IjMwMjEzMDA5MDYwNTJiMGUwMzAyMWEwNTAwMDQxNCIsc2hhMjI0OiIzMDJkMzAwZDA2MDk2MDg2NDgwMTY1MDMwNDAyMDQwNTAwMDQxYyIsc2hhMjU2OiIzMDMxMzAwZDA2MDk2MDg2NDgwMTY1MDMwNDAyMDEwNTAwMDQyMCIsc2hhMzg0OiIzMDQxMzAwZDA2MDk2MDg2NDgwMTY1MDMwNDAyMDIwNTAwMDQzMCIsc2hhNTEyOiIzMDUxMzAwZDA2MDk2MDg2NDgwMTY1MDMwNDAyMDMwNTAwMDQ0MCIscmlwZW1kMTYwOiIzMDIxMzAwOTA2MDUyYjI0MDMwMjAxMDUwMDA0MTQifSxpdD17fTtpdC5sYW5nPXtleHRlbmQ6ZnVuY3Rpb24odCxlLGkpe2lmKCFlfHwhdCl0aHJvdyBuZXcgRXJyb3IoIllBSE9PLmxhbmcuZXh0ZW5kIGZhaWxlZCwgcGxlYXNlIGNoZWNrIHRoYXQgYWxsIGRlcGVuZGVuY2llcyBhcmUgaW5jbHVkZWQuIik7dmFyIHI9ZnVuY3Rpb24oKXt9O2lmKHIucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyByLHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXQsdC5zdXBlcmNsYXNzPWUucHJvdG90eXBlLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPT1PYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yJiYoZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSksaSl7dmFyIG47Zm9yKG4gaW4gaSl0LnByb3RvdHlwZVtuXT1pW25dO3ZhciBzPWZ1bmN0aW9uKCl7fSxvPVsidG9TdHJpbmciLCJ2YWx1ZU9mIl07dHJ5ey9NU0lFLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpJiYocz1mdW5jdGlvbih0LGUpe2ZvcihuPTA7bjxvLmxlbmd0aDtuKz0xKXt2YXIgaT1vW25dLHI9ZVtpXTsiZnVuY3Rpb24iPT10eXBlb2YgciYmciE9T2JqZWN0LnByb3RvdHlwZVtpXSYmKHRbaV09cil9fSl9Y2F0Y2godCl7fXModC5wcm90b3R5cGUsaSl9fX07dmFyIHJ0PXt9O3ZvaWQgMCE9PXJ0LmFzbjEmJnJ0LmFzbjF8fChydC5hc24xPXt9KSxydC5hc24xLkFTTjFVdGlsPW5ldyBmdW5jdGlvbigpe3RoaXMuaW50ZWdlclRvQnl0ZUhleD1mdW5jdGlvbih0KXt2YXIgZT10LnRvU3RyaW5nKDE2KTtyZXR1cm4gZS5sZW5ndGglMj09MSYmKGU9IjAiK2UpLGV9LHRoaXMuYmlnSW50VG9NaW5Ud29zQ29tcGxlbWVudHNIZXg9ZnVuY3Rpb24odCl7dmFyIGU9dC50b1N0cmluZygxNik7aWYoIi0iIT1lLnN1YnN0cigwLDEpKWUubGVuZ3RoJTI9PTE/ZT0iMCIrZTplLm1hdGNoKC9eWzAtN10vKXx8KGU9IjAwIitlKTtlbHNle3ZhciBpPWUuc3Vic3RyKDEpLmxlbmd0aDtpJTI9PTE/aSs9MTplLm1hdGNoKC9eWzAtN10vKXx8KGkrPTIpO2Zvcih2YXIgcj0iIixuPTA7bjxpO24rKylyKz0iZiI7ZT1uZXcgQShyLDE2KS54b3IodCkuYWRkKEEuT05FKS50b1N0cmluZygxNikucmVwbGFjZSgvXi0vLCIiKX1yZXR1cm4gZX0sdGhpcy5nZXRQRU1TdHJpbmdGcm9tSGV4PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGhleHRvcGVtKHQsZSl9LHRoaXMubmV3T2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBlPXJ0LmFzbjEsaT1lLkRFUkJvb2xlYW4scj1lLkRFUkludGVnZXIsbj1lLkRFUkJpdFN0cmluZyxzPWUuREVST2N0ZXRTdHJpbmcsbz1lLkRFUk51bGwsaD1lLkRFUk9iamVjdElkZW50aWZpZXIsYT1lLkRFUkVudW1lcmF0ZWQsdT1lLkRFUlVURjhTdHJpbmcsYz1lLkRFUk51bWVyaWNTdHJpbmcsZj1lLkRFUlByaW50YWJsZVN0cmluZyxsPWUuREVSVGVsZXRleFN0cmluZyxwPWUuREVSSUE1U3RyaW5nLGc9ZS5ERVJVVENUaW1lLGQ9ZS5ERVJHZW5lcmFsaXplZFRpbWUsdj1lLkRFUlNlcXVlbmNlLG09ZS5ERVJTZXQseT1lLkRFUlRhZ2dlZE9iamVjdCxiPWUuQVNOMVV0aWwubmV3T2JqZWN0LFQ9T2JqZWN0LmtleXModCk7aWYoMSE9VC5sZW5ndGgpdGhyb3cia2V5IG9mIHBhcmFtIHNoYWxsIGJlIG9ubHkgb25lLiI7dmFyIFM9VFswXTtpZigtMT09Ijpib29sOmludDpiaXRzdHI6b2N0c3RyOm51bGw6b2lkOmVudW06dXRmOHN0cjpudW1zdHI6cHJuc3RyOnRlbHN0cjppYTVzdHI6dXRjdGltZTpnZW50aW1lOnNlcTpzZXQ6dGFnOiIuaW5kZXhPZigiOiIrUysiOiIpKXRocm93InVuZGVmaW5lZCBrZXk6ICIrUztpZigiYm9vbCI9PVMpcmV0dXJuIG5ldyBpKHRbU10pO2lmKCJpbnQiPT1TKXJldHVybiBuZXcgcih0W1NdKTtpZigiYml0c3RyIj09UylyZXR1cm4gbmV3IG4odFtTXSk7aWYoIm9jdHN0ciI9PVMpcmV0dXJuIG5ldyBzKHRbU10pO2lmKCJudWxsIj09UylyZXR1cm4gbmV3IG8odFtTXSk7aWYoIm9pZCI9PVMpcmV0dXJuIG5ldyBoKHRbU10pO2lmKCJlbnVtIj09UylyZXR1cm4gbmV3IGEodFtTXSk7aWYoInV0ZjhzdHIiPT1TKXJldHVybiBuZXcgdSh0W1NdKTtpZigibnVtc3RyIj09UylyZXR1cm4gbmV3IGModFtTXSk7aWYoInBybnN0ciI9PVMpcmV0dXJuIG5ldyBmKHRbU10pO2lmKCJ0ZWxzdHIiPT1TKXJldHVybiBuZXcgbCh0W1NdKTtpZigiaWE1c3RyIj09UylyZXR1cm4gbmV3IHAodFtTXSk7aWYoInV0Y3RpbWUiPT1TKXJldHVybiBuZXcgZyh0W1NdKTtpZigiZ2VudGltZSI9PVMpcmV0dXJuIG5ldyBkKHRbU10pO2lmKCJzZXEiPT1TKXtmb3IodmFyIEU9dFtTXSx3PVtdLEQ9MDtEPEUubGVuZ3RoO0QrKyl7dmFyIHg9YihFW0RdKTt3LnB1c2goeCl9cmV0dXJuIG5ldyB2KHthcnJheTp3fSl9aWYoInNldCI9PVMpe2ZvcihFPXRbU10sdz1bXSxEPTA7RDxFLmxlbmd0aDtEKyspeD1iKEVbRF0pLHcucHVzaCh4KTtyZXR1cm4gbmV3IG0oe2FycmF5Ond9KX1pZigidGFnIj09Uyl7dmFyIFI9dFtTXTtpZigiW29iamVjdCBBcnJheV0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFIpJiYzPT1SLmxlbmd0aCl7dmFyIEI9YihSWzJdKTtyZXR1cm4gbmV3IHkoe3RhZzpSWzBdLGV4cGxpY2l0OlJbMV0sb2JqOkJ9KX12YXIgTz17fTtpZih2b2lkIDAhPT1SLmV4cGxpY2l0JiYoTy5leHBsaWNpdD1SLmV4cGxpY2l0KSx2b2lkIDAhPT1SLnRhZyYmKE8udGFnPVIudGFnKSx2b2lkIDA9PT1SLm9iail0aHJvdyJvYmogc2hhbGwgYmUgc3BlY2lmaWVkIGZvciAndGFnJy4iO3JldHVybiBPLm9iaj1iKFIub2JqKSxuZXcgeShPKX19LHRoaXMuanNvblRvQVNOMUhFWD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5uZXdPYmplY3QodCkuZ2V0RW5jb2RlZEhleCgpfX0scnQuYXNuMS5BU04xVXRpbC5vaWRIZXhUb0ludD1mdW5jdGlvbih0KXtmb3IodmFyIGU9IiIsaT1wYXJzZUludCh0LnN1YnN0cigwLDIpLDE2KSxyPShlPU1hdGguZmxvb3IoaS80MCkrIi4iK2klNDAsIiIpLG49MjtuPHQubGVuZ3RoO24rPTIpe3ZhciBzPSgiMDAwMDAwMDAiK3BhcnNlSW50KHQuc3Vic3RyKG4sMiksMTYpLnRvU3RyaW5nKDIpKS5zbGljZSgtOCk7cis9cy5zdWJzdHIoMSw3KSwiMCI9PXMuc3Vic3RyKDAsMSkmJihlPWUrIi4iK25ldyBBKHIsMikudG9TdHJpbmcoMTApLHI9IiIpfXJldHVybiBlfSxydC5hc24xLkFTTjFVdGlsLm9pZEludFRvSGV4PWZ1bmN0aW9uKHQpe3ZhciBlPWZ1bmN0aW9uKHQpe3ZhciBlPXQudG9TdHJpbmcoMTYpO3JldHVybiAxPT1lLmxlbmd0aCYmKGU9IjAiK2UpLGV9LGk9ZnVuY3Rpb24odCl7dmFyIGk9IiIscj1uZXcgQSh0LDEwKS50b1N0cmluZygyKSxuPTctci5sZW5ndGglNzs3PT1uJiYobj0wKTtmb3IodmFyIHM9IiIsbz0wO288bjtvKyspcys9IjAiO2ZvcihyPXMrcixvPTA7bzxyLmxlbmd0aC0xO28rPTcpe3ZhciBoPXIuc3Vic3RyKG8sNyk7byE9ci5sZW5ndGgtNyYmKGg9IjEiK2gpLGkrPWUocGFyc2VJbnQoaCwyKSl9cmV0dXJuIGl9O2lmKCF0Lm1hdGNoKC9eWzAtOS5dKyQvKSl0aHJvdyJtYWxmb3JtZWQgb2lkIHN0cmluZzogIit0O3ZhciByPSIiLG49dC5zcGxpdCgiLiIpLHM9NDAqcGFyc2VJbnQoblswXSkrcGFyc2VJbnQoblsxXSk7cis9ZShzKSxuLnNwbGljZSgwLDIpO2Zvcih2YXIgbz0wO288bi5sZW5ndGg7bysrKXIrPWkobltvXSk7cmV0dXJuIHJ9LHJ0LmFzbjEuQVNOMU9iamVjdD1mdW5jdGlvbigpe3RoaXMuZ2V0TGVuZ3RoSGV4RnJvbVZhbHVlPWZ1bmN0aW9uKCl7aWYodm9pZCAwPT09dGhpcy5oVnx8bnVsbD09dGhpcy5oVil0aHJvdyJ0aGlzLmhWIGlzIG51bGwgb3IgdW5kZWZpbmVkLiI7aWYodGhpcy5oVi5sZW5ndGglMj09MSl0aHJvdyJ2YWx1ZSBoZXggbXVzdCBiZSBldmVuIGxlbmd0aDogbj0iKyIiLmxlbmd0aCsiLHY9Iit0aGlzLmhWO3ZhciB0PXRoaXMuaFYubGVuZ3RoLzIsZT10LnRvU3RyaW5nKDE2KTtpZihlLmxlbmd0aCUyPT0xJiYoZT0iMCIrZSksdDwxMjgpcmV0dXJuIGU7dmFyIGk9ZS5sZW5ndGgvMjtpZihpPjE1KXRocm93IkFTTi4xIGxlbmd0aCB0b28gbG9uZyB0byByZXByZXNlbnQgYnkgOHg6IG4gPSAiK3QudG9TdHJpbmcoMTYpO3JldHVybigxMjgraSkudG9TdHJpbmcoMTYpK2V9LHRoaXMuZ2V0RW5jb2RlZEhleD1mdW5jdGlvbigpe3JldHVybihudWxsPT10aGlzLmhUTFZ8fHRoaXMuaXNNb2RpZmllZCkmJih0aGlzLmhWPXRoaXMuZ2V0RnJlc2hWYWx1ZUhleCgpLHRoaXMuaEw9dGhpcy5nZXRMZW5ndGhIZXhGcm9tVmFsdWUoKSx0aGlzLmhUTFY9dGhpcy5oVCt0aGlzLmhMK3RoaXMuaFYsdGhpcy5pc01vZGlmaWVkPSExKSx0aGlzLmhUTFZ9LHRoaXMuZ2V0VmFsdWVIZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRFbmNvZGVkSGV4KCksdGhpcy5oVn0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIiJ9fSxydC5hc24xLkRFUkFic3RyYWN0U3RyaW5nPWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSQWJzdHJhY3RTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuZ2V0U3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc30sdGhpcy5zZXRTdHJpbmc9ZnVuY3Rpb24odCl7dGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwLHRoaXMucz10LHRoaXMuaFY9c3RvaGV4KHRoaXMucyl9LHRoaXMuc2V0U3RyaW5nSGV4PWZ1bmN0aW9uKHQpe3RoaXMuaFRMVj1udWxsLHRoaXMuaXNNb2RpZmllZD0hMCx0aGlzLnM9bnVsbCx0aGlzLmhWPXR9LHRoaXMuZ2V0RnJlc2hWYWx1ZUhleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhWfSx2b2lkIDAhPT10JiYoInN0cmluZyI9PXR5cGVvZiB0P3RoaXMuc2V0U3RyaW5nKHQpOnZvaWQgMCE9PXQuc3RyP3RoaXMuc2V0U3RyaW5nKHQuc3RyKTp2b2lkIDAhPT10LmhleCYmdGhpcy5zZXRTdHJpbmdIZXgodC5oZXgpKX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJBYnN0cmFjdFN0cmluZyxydC5hc24xLkFTTjFPYmplY3QpLHJ0LmFzbjEuREVSQWJzdHJhY3RUaW1lPWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSQWJzdHJhY3RUaW1lLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzKSx0aGlzLmxvY2FsRGF0ZVRvVVRDPWZ1bmN0aW9uKHQpe3JldHVybiB1dGM9dC5nZXRUaW1lKCkrNmU0KnQuZ2V0VGltZXpvbmVPZmZzZXQoKSxuZXcgRGF0ZSh1dGMpfSx0aGlzLmZvcm1hdERhdGU9ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuemVyb1BhZGRpbmcsbj10aGlzLmxvY2FsRGF0ZVRvVVRDKHQpLHM9U3RyaW5nKG4uZ2V0RnVsbFllYXIoKSk7InV0YyI9PWUmJihzPXMuc3Vic3RyKDIsMikpO3ZhciBvPXMrcihTdHJpbmcobi5nZXRNb250aCgpKzEpLDIpK3IoU3RyaW5nKG4uZ2V0RGF0ZSgpKSwyKStyKFN0cmluZyhuLmdldEhvdXJzKCkpLDIpK3IoU3RyaW5nKG4uZ2V0TWludXRlcygpKSwyKStyKFN0cmluZyhuLmdldFNlY29uZHMoKSksMik7aWYoITA9PT1pKXt2YXIgaD1uLmdldE1pbGxpc2Vjb25kcygpO2lmKDAhPWgpe3ZhciBhPXIoU3RyaW5nKGgpLDMpO289bysiLiIrKGE9YS5yZXBsYWNlKC9bMF0rJC8sIiIpKX19cmV0dXJuIG8rIloifSx0aGlzLnplcm9QYWRkaW5nPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQubGVuZ3RoPj1lP3Q6bmV3IEFycmF5KGUtdC5sZW5ndGgrMSkuam9pbigiMCIpK3R9LHRoaXMuZ2V0U3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc30sdGhpcy5zZXRTdHJpbmc9ZnVuY3Rpb24odCl7dGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwLHRoaXMucz10LHRoaXMuaFY9c3RvaGV4KHQpfSx0aGlzLnNldEJ5RGF0ZVZhbHVlPWZ1bmN0aW9uKHQsZSxpLHIsbixzKXt2YXIgbz1uZXcgRGF0ZShEYXRlLlVUQyh0LGUtMSxpLHIsbixzLDApKTt0aGlzLnNldEJ5RGF0ZShvKX0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaFZ9fSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUkFic3RyYWN0VGltZSxydC5hc24xLkFTTjFPYmplY3QpLHJ0LmFzbjEuREVSQWJzdHJhY3RTdHJ1Y3R1cmVkPWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSQWJzdHJhY3RTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuc2V0QnlBU04xT2JqZWN0QXJyYXk9ZnVuY3Rpb24odCl7dGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwLHRoaXMuYXNuMUFycmF5PXR9LHRoaXMuYXBwZW5kQVNOMU9iamVjdD1mdW5jdGlvbih0KXt0aGlzLmhUTFY9bnVsbCx0aGlzLmlzTW9kaWZpZWQ9ITAsdGhpcy5hc24xQXJyYXkucHVzaCh0KX0sdGhpcy5hc24xQXJyYXk9bmV3IEFycmF5LHZvaWQgMCE9PXQmJnZvaWQgMCE9PXQuYXJyYXkmJih0aGlzLmFzbjFBcnJheT10LmFycmF5KX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJBYnN0cmFjdFN0cnVjdHVyZWQscnQuYXNuMS5BU04xT2JqZWN0KSxydC5hc24xLkRFUkJvb2xlYW49ZnVuY3Rpb24oKXtydC5hc24xLkRFUkJvb2xlYW4uc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuaFQ9IjAxIix0aGlzLmhUTFY9IjAxMDFmZiJ9LGl0LmxhbmcuZXh0ZW5kKHJ0LmFzbjEuREVSQm9vbGVhbixydC5hc24xLkFTTjFPYmplY3QpLHJ0LmFzbjEuREVSSW50ZWdlcj1mdW5jdGlvbih0KXtydC5hc24xLkRFUkludGVnZXIuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuaFQ9IjAyIix0aGlzLnNldEJ5QmlnSW50ZWdlcj1mdW5jdGlvbih0KXt0aGlzLmhUTFY9bnVsbCx0aGlzLmlzTW9kaWZpZWQ9ITAsdGhpcy5oVj1ydC5hc24xLkFTTjFVdGlsLmJpZ0ludFRvTWluVHdvc0NvbXBsZW1lbnRzSGV4KHQpfSx0aGlzLnNldEJ5SW50ZWdlcj1mdW5jdGlvbih0KXt2YXIgZT1uZXcgQShTdHJpbmcodCksMTApO3RoaXMuc2V0QnlCaWdJbnRlZ2VyKGUpfSx0aGlzLnNldFZhbHVlSGV4PWZ1bmN0aW9uKHQpe3RoaXMuaFY9dH0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaFZ9LHZvaWQgMCE9PXQmJih2b2lkIDAhPT10LmJpZ2ludD90aGlzLnNldEJ5QmlnSW50ZWdlcih0LmJpZ2ludCk6dm9pZCAwIT09dC5pbnQ/dGhpcy5zZXRCeUludGVnZXIodC5pbnQpOiJudW1iZXIiPT10eXBlb2YgdD90aGlzLnNldEJ5SW50ZWdlcih0KTp2b2lkIDAhPT10LmhleCYmdGhpcy5zZXRWYWx1ZUhleCh0LmhleCkpfSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUkludGVnZXIscnQuYXNuMS5BU04xT2JqZWN0KSxydC5hc24xLkRFUkJpdFN0cmluZz1mdW5jdGlvbih0KXtpZih2b2lkIDAhPT10JiZ2b2lkIDAhPT10Lm9iail7dmFyIGU9cnQuYXNuMS5BU04xVXRpbC5uZXdPYmplY3QodC5vYmopO3QuaGV4PSIwMCIrZS5nZXRFbmNvZGVkSGV4KCl9cnQuYXNuMS5ERVJCaXRTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuaFQ9IjAzIix0aGlzLnNldEhleFZhbHVlSW5jbHVkaW5nVW51c2VkQml0cz1mdW5jdGlvbih0KXt0aGlzLmhUTFY9bnVsbCx0aGlzLmlzTW9kaWZpZWQ9ITAsdGhpcy5oVj10fSx0aGlzLnNldFVudXNlZEJpdHNBbmRIZXhWYWx1ZT1mdW5jdGlvbih0LGUpe2lmKHQ8MHx8Nzx0KXRocm93InVudXNlZCBiaXRzIHNoYWxsIGJlIGZyb20gMCB0byA3OiB1ID0gIit0O3ZhciBpPSIwIit0O3RoaXMuaFRMVj1udWxsLHRoaXMuaXNNb2RpZmllZD0hMCx0aGlzLmhWPWkrZX0sdGhpcy5zZXRCeUJpbmFyeVN0cmluZz1mdW5jdGlvbih0KXt2YXIgZT04LSh0PXQucmVwbGFjZSgvMCskLywiIikpLmxlbmd0aCU4Ozg9PWUmJihlPTApO2Zvcih2YXIgaT0wO2k8PWU7aSsrKXQrPSIwIjt2YXIgcj0iIjtmb3IoaT0wO2k8dC5sZW5ndGgtMTtpKz04KXt2YXIgbj10LnN1YnN0cihpLDgpLHM9cGFyc2VJbnQobiwyKS50b1N0cmluZygxNik7MT09cy5sZW5ndGgmJihzPSIwIitzKSxyKz1zfXRoaXMuaFRMVj1udWxsLHRoaXMuaXNNb2RpZmllZD0hMCx0aGlzLmhWPSIwIitlK3J9LHRoaXMuc2V0QnlCb29sZWFuQXJyYXk9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPSIiLGk9MDtpPHQubGVuZ3RoO2krKykxPT10W2ldP2UrPSIxIjplKz0iMCI7dGhpcy5zZXRCeUJpbmFyeVN0cmluZyhlKX0sdGhpcy5uZXdGYWxzZUFycmF5PWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1uZXcgQXJyYXkodCksaT0wO2k8dDtpKyspZVtpXT0hMTtyZXR1cm4gZX0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaFZ9LHZvaWQgMCE9PXQmJigic3RyaW5nIj09dHlwZW9mIHQmJnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvXlswLTlhLWZdKyQvKT90aGlzLnNldEhleFZhbHVlSW5jbHVkaW5nVW51c2VkQml0cyh0KTp2b2lkIDAhPT10LmhleD90aGlzLnNldEhleFZhbHVlSW5jbHVkaW5nVW51c2VkQml0cyh0LmhleCk6dm9pZCAwIT09dC5iaW4/dGhpcy5zZXRCeUJpbmFyeVN0cmluZyh0LmJpbik6dm9pZCAwIT09dC5hcnJheSYmdGhpcy5zZXRCeUJvb2xlYW5BcnJheSh0LmFycmF5KSl9LGl0LmxhbmcuZXh0ZW5kKHJ0LmFzbjEuREVSQml0U3RyaW5nLHJ0LmFzbjEuQVNOMU9iamVjdCkscnQuYXNuMS5ERVJPY3RldFN0cmluZz1mdW5jdGlvbih0KXtpZih2b2lkIDAhPT10JiZ2b2lkIDAhPT10Lm9iail7dmFyIGU9cnQuYXNuMS5BU04xVXRpbC5uZXdPYmplY3QodC5vYmopO3QuaGV4PWUuZ2V0RW5jb2RlZEhleCgpfXJ0LmFzbjEuREVST2N0ZXRTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsdCksdGhpcy5oVD0iMDQifSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUk9jdGV0U3RyaW5nLHJ0LmFzbjEuREVSQWJzdHJhY3RTdHJpbmcpLHJ0LmFzbjEuREVSTnVsbD1mdW5jdGlvbigpe3J0LmFzbjEuREVSTnVsbC5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwodGhpcyksdGhpcy5oVD0iMDUiLHRoaXMuaFRMVj0iMDUwMCJ9LGl0LmxhbmcuZXh0ZW5kKHJ0LmFzbjEuREVSTnVsbCxydC5hc24xLkFTTjFPYmplY3QpLHJ0LmFzbjEuREVST2JqZWN0SWRlbnRpZmllcj1mdW5jdGlvbih0KXt2YXIgZT1mdW5jdGlvbih0KXt2YXIgZT10LnRvU3RyaW5nKDE2KTtyZXR1cm4gMT09ZS5sZW5ndGgmJihlPSIwIitlKSxlfSxpPWZ1bmN0aW9uKHQpe3ZhciBpPSIiLHI9bmV3IEEodCwxMCkudG9TdHJpbmcoMiksbj03LXIubGVuZ3RoJTc7Nz09biYmKG49MCk7Zm9yKHZhciBzPSIiLG89MDtvPG47bysrKXMrPSIwIjtmb3Iocj1zK3Isbz0wO288ci5sZW5ndGgtMTtvKz03KXt2YXIgaD1yLnN1YnN0cihvLDcpO28hPXIubGVuZ3RoLTcmJihoPSIxIitoKSxpKz1lKHBhcnNlSW50KGgsMikpfXJldHVybiBpfTtydC5hc24xLkRFUk9iamVjdElkZW50aWZpZXIuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpLHRoaXMuaFQ9IjA2Iix0aGlzLnNldFZhbHVlSGV4PWZ1bmN0aW9uKHQpe3RoaXMuaFRMVj1udWxsLHRoaXMuaXNNb2RpZmllZD0hMCx0aGlzLnM9bnVsbCx0aGlzLmhWPXR9LHRoaXMuc2V0VmFsdWVPaWRTdHJpbmc9ZnVuY3Rpb24odCl7aWYoIXQubWF0Y2goL15bMC05Ll0rJC8pKXRocm93Im1hbGZvcm1lZCBvaWQgc3RyaW5nOiAiK3Q7dmFyIHI9IiIsbj10LnNwbGl0KCIuIikscz00MCpwYXJzZUludChuWzBdKStwYXJzZUludChuWzFdKTtyKz1lKHMpLG4uc3BsaWNlKDAsMik7Zm9yKHZhciBvPTA7bzxuLmxlbmd0aDtvKyspcis9aShuW29dKTt0aGlzLmhUTFY9bnVsbCx0aGlzLmlzTW9kaWZpZWQ9ITAsdGhpcy5zPW51bGwsdGhpcy5oVj1yfSx0aGlzLnNldFZhbHVlTmFtZT1mdW5jdGlvbih0KXt2YXIgZT1ydC5hc24xLng1MDkuT0lELm5hbWUyb2lkKHQpO2lmKCIiPT09ZSl0aHJvdyJERVJPYmplY3RJZGVudGlmaWVyIG9pZE5hbWUgdW5kZWZpbmVkOiAiK3Q7dGhpcy5zZXRWYWx1ZU9pZFN0cmluZyhlKX0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaFZ9LHZvaWQgMCE9PXQmJigic3RyaW5nIj09dHlwZW9mIHQ/dC5tYXRjaCgvXlswLTJdLlswLTkuXSskLyk/dGhpcy5zZXRWYWx1ZU9pZFN0cmluZyh0KTp0aGlzLnNldFZhbHVlTmFtZSh0KTp2b2lkIDAhPT10Lm9pZD90aGlzLnNldFZhbHVlT2lkU3RyaW5nKHQub2lkKTp2b2lkIDAhPT10LmhleD90aGlzLnNldFZhbHVlSGV4KHQuaGV4KTp2b2lkIDAhPT10Lm5hbWUmJnRoaXMuc2V0VmFsdWVOYW1lKHQubmFtZSkpfSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUk9iamVjdElkZW50aWZpZXIscnQuYXNuMS5BU04xT2JqZWN0KSxydC5hc24xLkRFUkVudW1lcmF0ZWQ9ZnVuY3Rpb24odCl7cnQuYXNuMS5ERVJFbnVtZXJhdGVkLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzKSx0aGlzLmhUPSIwYSIsdGhpcy5zZXRCeUJpZ0ludGVnZXI9ZnVuY3Rpb24odCl7dGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwLHRoaXMuaFY9cnQuYXNuMS5BU04xVXRpbC5iaWdJbnRUb01pblR3b3NDb21wbGVtZW50c0hleCh0KX0sdGhpcy5zZXRCeUludGVnZXI9ZnVuY3Rpb24odCl7dmFyIGU9bmV3IEEoU3RyaW5nKHQpLDEwKTt0aGlzLnNldEJ5QmlnSW50ZWdlcihlKX0sdGhpcy5zZXRWYWx1ZUhleD1mdW5jdGlvbih0KXt0aGlzLmhWPXR9LHRoaXMuZ2V0RnJlc2hWYWx1ZUhleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhWfSx2b2lkIDAhPT10JiYodm9pZCAwIT09dC5pbnQ/dGhpcy5zZXRCeUludGVnZXIodC5pbnQpOiJudW1iZXIiPT10eXBlb2YgdD90aGlzLnNldEJ5SW50ZWdlcih0KTp2b2lkIDAhPT10LmhleCYmdGhpcy5zZXRWYWx1ZUhleCh0LmhleCkpfSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUkVudW1lcmF0ZWQscnQuYXNuMS5BU04xT2JqZWN0KSxydC5hc24xLkRFUlVURjhTdHJpbmc9ZnVuY3Rpb24odCl7cnQuYXNuMS5ERVJVVEY4U3RyaW5nLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLHQpLHRoaXMuaFQ9IjBjIn0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJVVEY4U3RyaW5nLHJ0LmFzbjEuREVSQWJzdHJhY3RTdHJpbmcpLHJ0LmFzbjEuREVSTnVtZXJpY1N0cmluZz1mdW5jdGlvbih0KXtydC5hc24xLkRFUk51bWVyaWNTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsdCksdGhpcy5oVD0iMTIifSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUk51bWVyaWNTdHJpbmcscnQuYXNuMS5ERVJBYnN0cmFjdFN0cmluZykscnQuYXNuMS5ERVJQcmludGFibGVTdHJpbmc9ZnVuY3Rpb24odCl7cnQuYXNuMS5ERVJQcmludGFibGVTdHJpbmcuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsdCksdGhpcy5oVD0iMTMifSxpdC5sYW5nLmV4dGVuZChydC5hc24xLkRFUlByaW50YWJsZVN0cmluZyxydC5hc24xLkRFUkFic3RyYWN0U3RyaW5nKSxydC5hc24xLkRFUlRlbGV0ZXhTdHJpbmc9ZnVuY3Rpb24odCl7cnQuYXNuMS5ERVJUZWxldGV4U3RyaW5nLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLHQpLHRoaXMuaFQ9IjE0In0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJUZWxldGV4U3RyaW5nLHJ0LmFzbjEuREVSQWJzdHJhY3RTdHJpbmcpLHJ0LmFzbjEuREVSSUE1U3RyaW5nPWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSSUE1U3RyaW5nLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLHQpLHRoaXMuaFQ9IjE2In0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJJQTVTdHJpbmcscnQuYXNuMS5ERVJBYnN0cmFjdFN0cmluZykscnQuYXNuMS5ERVJVVENUaW1lPWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSVVRDVGltZS5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwodGhpcyx0KSx0aGlzLmhUPSIxNyIsdGhpcy5zZXRCeURhdGU9ZnVuY3Rpb24odCl7dGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwLHRoaXMuZGF0ZT10LHRoaXMucz10aGlzLmZvcm1hdERhdGUodGhpcy5kYXRlLCJ1dGMiKSx0aGlzLmhWPXN0b2hleCh0aGlzLnMpfSx0aGlzLmdldEZyZXNoVmFsdWVIZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdm9pZCAwPT09dGhpcy5kYXRlJiZ2b2lkIDA9PT10aGlzLnMmJih0aGlzLmRhdGU9bmV3IERhdGUsdGhpcy5zPXRoaXMuZm9ybWF0RGF0ZSh0aGlzLmRhdGUsInV0YyIpLHRoaXMuaFY9c3RvaGV4KHRoaXMucykpLHRoaXMuaFZ9LHZvaWQgMCE9PXQmJih2b2lkIDAhPT10LnN0cj90aGlzLnNldFN0cmluZyh0LnN0cik6InN0cmluZyI9PXR5cGVvZiB0JiZ0Lm1hdGNoKC9eWzAtOV17MTJ9WiQvKT90aGlzLnNldFN0cmluZyh0KTp2b2lkIDAhPT10LmhleD90aGlzLnNldFN0cmluZ0hleCh0LmhleCk6dm9pZCAwIT09dC5kYXRlJiZ0aGlzLnNldEJ5RGF0ZSh0LmRhdGUpKX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJVVENUaW1lLHJ0LmFzbjEuREVSQWJzdHJhY3RUaW1lKSxydC5hc24xLkRFUkdlbmVyYWxpemVkVGltZT1mdW5jdGlvbih0KXtydC5hc24xLkRFUkdlbmVyYWxpemVkVGltZS5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwodGhpcyx0KSx0aGlzLmhUPSIxOCIsdGhpcy53aXRoTWlsbGlzPSExLHRoaXMuc2V0QnlEYXRlPWZ1bmN0aW9uKHQpe3RoaXMuaFRMVj1udWxsLHRoaXMuaXNNb2RpZmllZD0hMCx0aGlzLmRhdGU9dCx0aGlzLnM9dGhpcy5mb3JtYXREYXRlKHRoaXMuZGF0ZSwiZ2VuIix0aGlzLndpdGhNaWxsaXMpLHRoaXMuaFY9c3RvaGV4KHRoaXMucyl9LHRoaXMuZ2V0RnJlc2hWYWx1ZUhleD1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT10aGlzLmRhdGUmJnZvaWQgMD09PXRoaXMucyYmKHRoaXMuZGF0ZT1uZXcgRGF0ZSx0aGlzLnM9dGhpcy5mb3JtYXREYXRlKHRoaXMuZGF0ZSwiZ2VuIix0aGlzLndpdGhNaWxsaXMpLHRoaXMuaFY9c3RvaGV4KHRoaXMucykpLHRoaXMuaFZ9LHZvaWQgMCE9PXQmJih2b2lkIDAhPT10LnN0cj90aGlzLnNldFN0cmluZyh0LnN0cik6InN0cmluZyI9PXR5cGVvZiB0JiZ0Lm1hdGNoKC9eWzAtOV17MTR9WiQvKT90aGlzLnNldFN0cmluZyh0KTp2b2lkIDAhPT10LmhleD90aGlzLnNldFN0cmluZ0hleCh0LmhleCk6dm9pZCAwIT09dC5kYXRlJiZ0aGlzLnNldEJ5RGF0ZSh0LmRhdGUpLCEwPT09dC5taWxsaXMmJih0aGlzLndpdGhNaWxsaXM9ITApKX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJHZW5lcmFsaXplZFRpbWUscnQuYXNuMS5ERVJBYnN0cmFjdFRpbWUpLHJ0LmFzbjEuREVSU2VxdWVuY2U9ZnVuY3Rpb24odCl7cnQuYXNuMS5ERVJTZXF1ZW5jZS5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwodGhpcyx0KSx0aGlzLmhUPSIzMCIsdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7Zm9yKHZhciB0PSIiLGU9MDtlPHRoaXMuYXNuMUFycmF5Lmxlbmd0aDtlKyspdCs9dGhpcy5hc24xQXJyYXlbZV0uZ2V0RW5jb2RlZEhleCgpO3JldHVybiB0aGlzLmhWPXQsdGhpcy5oVn19LGl0LmxhbmcuZXh0ZW5kKHJ0LmFzbjEuREVSU2VxdWVuY2UscnQuYXNuMS5ERVJBYnN0cmFjdFN0cnVjdHVyZWQpLHJ0LmFzbjEuREVSU2V0PWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSU2V0LnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLHQpLHRoaXMuaFQ9IjMxIix0aGlzLnNvcnRGbGFnPSEwLHRoaXMuZ2V0RnJlc2hWYWx1ZUhleD1mdW5jdGlvbigpe2Zvcih2YXIgdD1uZXcgQXJyYXksZT0wO2U8dGhpcy5hc24xQXJyYXkubGVuZ3RoO2UrKyl7dmFyIGk9dGhpcy5hc24xQXJyYXlbZV07dC5wdXNoKGkuZ2V0RW5jb2RlZEhleCgpKX1yZXR1cm4gMT09dGhpcy5zb3J0RmxhZyYmdC5zb3J0KCksdGhpcy5oVj10LmpvaW4oIiIpLHRoaXMuaFZ9LHZvaWQgMCE9PXQmJnZvaWQgMCE9PXQuc29ydGZsYWcmJjA9PXQuc29ydGZsYWcmJih0aGlzLnNvcnRGbGFnPSExKX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJTZXQscnQuYXNuMS5ERVJBYnN0cmFjdFN0cnVjdHVyZWQpLHJ0LmFzbjEuREVSVGFnZ2VkT2JqZWN0PWZ1bmN0aW9uKHQpe3J0LmFzbjEuREVSVGFnZ2VkT2JqZWN0LnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzKSx0aGlzLmhUPSJhMCIsdGhpcy5oVj0iIix0aGlzLmlzRXhwbGljaXQ9ITAsdGhpcy5hc24xT2JqZWN0PW51bGwsdGhpcy5zZXRBU04xT2JqZWN0PWZ1bmN0aW9uKHQsZSxpKXt0aGlzLmhUPWUsdGhpcy5pc0V4cGxpY2l0PXQsdGhpcy5hc24xT2JqZWN0PWksdGhpcy5pc0V4cGxpY2l0Pyh0aGlzLmhWPXRoaXMuYXNuMU9iamVjdC5nZXRFbmNvZGVkSGV4KCksdGhpcy5oVExWPW51bGwsdGhpcy5pc01vZGlmaWVkPSEwKToodGhpcy5oVj1udWxsLHRoaXMuaFRMVj1pLmdldEVuY29kZWRIZXgoKSx0aGlzLmhUTFY9dGhpcy5oVExWLnJlcGxhY2UoL14uLi8sZSksdGhpcy5pc01vZGlmaWVkPSExKX0sdGhpcy5nZXRGcmVzaFZhbHVlSGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaFZ9LHZvaWQgMCE9PXQmJih2b2lkIDAhPT10LnRhZyYmKHRoaXMuaFQ9dC50YWcpLHZvaWQgMCE9PXQuZXhwbGljaXQmJih0aGlzLmlzRXhwbGljaXQ9dC5leHBsaWNpdCksdm9pZCAwIT09dC5vYmomJih0aGlzLmFzbjFPYmplY3Q9dC5vYmosdGhpcy5zZXRBU04xT2JqZWN0KHRoaXMuaXNFeHBsaWNpdCx0aGlzLmhULHRoaXMuYXNuMU9iamVjdCkpKX0saXQubGFuZy5leHRlbmQocnQuYXNuMS5ERVJUYWdnZWRPYmplY3QscnQuYXNuMS5BU04xT2JqZWN0KTt2YXIgbnQsc3Qsb3Q9KG50PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG50PU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbih0LGUpe3QuX19wcm90b19fPWV9fHxmdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLGkpJiYodFtpXT1lW2ldKX0sbnQodCxlKX0sZnVuY3Rpb24odCxlKXtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSYmbnVsbCE9PWUpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSAiK1N0cmluZyhlKSsiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGwiKTtmdW5jdGlvbiBpKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fW50KHQsZSksdC5wcm90b3R5cGU9bnVsbD09PWU/T2JqZWN0LmNyZWF0ZShlKTooaS5wcm90b3R5cGU9ZS5wcm90b3R5cGUsbmV3IGkpfSksaHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShpKXt2YXIgcj10LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGkmJigic3RyaW5nIj09dHlwZW9mIGk/ci5wYXJzZUtleShpKTooZS5oYXNQcml2YXRlS2V5UHJvcGVydHkoaSl8fGUuaGFzUHVibGljS2V5UHJvcGVydHkoaSkpJiZyLnBhcnNlUHJvcGVydGllc0Zyb20oaSkpLHJ9cmV0dXJuIG90KGUsdCksZS5wcm90b3R5cGUucGFyc2VLZXk9ZnVuY3Rpb24odCl7dHJ5e3ZhciBlPTAsaT0wLHI9L15ccyooPzpbMC05QS1GYS1mXVswLTlBLUZhLWZdXHMqKSskLy50ZXN0KHQpP2Z1bmN0aW9uKHQpe3ZhciBlO2lmKHZvaWQgMD09PWMpe3ZhciBpPSIwMTIzNDU2Nzg5QUJDREVGIixyPSIgXGZcblxyXHQgXHUyMDI4XHUyMDI5Ijtmb3IoYz17fSxlPTA7ZTwxNjsrK2UpY1tpLmNoYXJBdChlKV09ZTtmb3IoaT1pLnRvTG93ZXJDYXNlKCksZT0xMDtlPDE2OysrZSljW2kuY2hhckF0KGUpXT1lO2ZvcihlPTA7ZTxyLmxlbmd0aDsrK2UpY1tyLmNoYXJBdChlKV09LTF9dmFyIG49W10scz0wLG89MDtmb3IoZT0wO2U8dC5sZW5ndGg7KytlKXt2YXIgaD10LmNoYXJBdChlKTtpZigiPSI9PWgpYnJlYWs7aWYoLTEhPShoPWNbaF0pKXtpZih2b2lkIDA9PT1oKXRocm93IG5ldyBFcnJvcigiSWxsZWdhbCBjaGFyYWN0ZXIgYXQgb2Zmc2V0ICIrZSk7c3w9aCwrK28+PTI/KG5bbi5sZW5ndGhdPXMscz0wLG89MCk6czw8PTR9fWlmKG8pdGhyb3cgbmV3IEVycm9yKCJIZXggZW5jb2RpbmcgaW5jb21wbGV0ZTogNCBiaXRzIG1pc3NpbmciKTtyZXR1cm4gbn0odCk6di51bmFybW9yKHQpLG49eC5kZWNvZGUocik7aWYoMz09PW4uc3ViLmxlbmd0aCYmKG49bi5zdWJbMl0uc3ViWzBdKSw5PT09bi5zdWIubGVuZ3RoKXtlPW4uc3ViWzFdLmdldEhleFN0cmluZ1ZhbHVlKCksdGhpcy5uPUwoZSwxNiksaT1uLnN1YlsyXS5nZXRIZXhTdHJpbmdWYWx1ZSgpLHRoaXMuZT1wYXJzZUludChpLDE2KTt2YXIgcz1uLnN1YlszXS5nZXRIZXhTdHJpbmdWYWx1ZSgpO3RoaXMuZD1MKHMsMTYpO3ZhciBvPW4uc3ViWzRdLmdldEhleFN0cmluZ1ZhbHVlKCk7dGhpcy5wPUwobywxNik7dmFyIGg9bi5zdWJbNV0uZ2V0SGV4U3RyaW5nVmFsdWUoKTt0aGlzLnE9TChoLDE2KTt2YXIgYT1uLnN1Yls2XS5nZXRIZXhTdHJpbmdWYWx1ZSgpO3RoaXMuZG1wMT1MKGEsMTYpO3ZhciB1PW4uc3ViWzddLmdldEhleFN0cmluZ1ZhbHVlKCk7dGhpcy5kbXExPUwodSwxNik7dmFyIGY9bi5zdWJbOF0uZ2V0SGV4U3RyaW5nVmFsdWUoKTt0aGlzLmNvZWZmPUwoZiwxNil9ZWxzZXtpZigyIT09bi5zdWIubGVuZ3RoKXJldHVybiExO2lmKG4uc3ViWzBdLnN1Yil7dmFyIGw9bi5zdWJbMV0uc3ViWzBdO2U9bC5zdWJbMF0uZ2V0SGV4U3RyaW5nVmFsdWUoKSx0aGlzLm49TChlLDE2KSxpPWwuc3ViWzFdLmdldEhleFN0cmluZ1ZhbHVlKCksdGhpcy5lPXBhcnNlSW50KGksMTYpfWVsc2UgZT1uLnN1YlswXS5nZXRIZXhTdHJpbmdWYWx1ZSgpLHRoaXMubj1MKGUsMTYpLGk9bi5zdWJbMV0uZ2V0SGV4U3RyaW5nVmFsdWUoKSx0aGlzLmU9cGFyc2VJbnQoaSwxNil9cmV0dXJuITB9Y2F0Y2godCl7cmV0dXJuITF9fSxlLnByb3RvdHlwZS5nZXRQcml2YXRlQmFzZUtleT1mdW5jdGlvbigpe3ZhciB0PXthcnJheTpbbmV3IHJ0LmFzbjEuREVSSW50ZWdlcih7aW50OjB9KSxuZXcgcnQuYXNuMS5ERVJJbnRlZ2VyKHtiaWdpbnQ6dGhpcy5ufSksbmV3IHJ0LmFzbjEuREVSSW50ZWdlcih7aW50OnRoaXMuZX0pLG5ldyBydC5hc24xLkRFUkludGVnZXIoe2JpZ2ludDp0aGlzLmR9KSxuZXcgcnQuYXNuMS5ERVJJbnRlZ2VyKHtiaWdpbnQ6dGhpcy5wfSksbmV3IHJ0LmFzbjEuREVSSW50ZWdlcih7YmlnaW50OnRoaXMucX0pLG5ldyBydC5hc24xLkRFUkludGVnZXIoe2JpZ2ludDp0aGlzLmRtcDF9KSxuZXcgcnQuYXNuMS5ERVJJbnRlZ2VyKHtiaWdpbnQ6dGhpcy5kbXExfSksbmV3IHJ0LmFzbjEuREVSSW50ZWdlcih7YmlnaW50OnRoaXMuY29lZmZ9KV19O3JldHVybiBuZXcgcnQuYXNuMS5ERVJTZXF1ZW5jZSh0KS5nZXRFbmNvZGVkSGV4KCl9LGUucHJvdG90eXBlLmdldFByaXZhdGVCYXNlS2V5QjY0PWZ1bmN0aW9uKCl7cmV0dXJuIHAodGhpcy5nZXRQcml2YXRlQmFzZUtleSgpKX0sZS5wcm90b3R5cGUuZ2V0UHVibGljQmFzZUtleT1mdW5jdGlvbigpe3ZhciB0PW5ldyBydC5hc24xLkRFUlNlcXVlbmNlKHthcnJheTpbbmV3IHJ0LmFzbjEuREVST2JqZWN0SWRlbnRpZmllcih7b2lkOiIxLjIuODQwLjExMzU0OS4xLjEuMSJ9KSxuZXcgcnQuYXNuMS5ERVJOdWxsXX0pLGU9bmV3IHJ0LmFzbjEuREVSU2VxdWVuY2Uoe2FycmF5OltuZXcgcnQuYXNuMS5ERVJJbnRlZ2VyKHtiaWdpbnQ6dGhpcy5ufSksbmV3IHJ0LmFzbjEuREVSSW50ZWdlcih7aW50OnRoaXMuZX0pXX0pLGk9bmV3IHJ0LmFzbjEuREVSQml0U3RyaW5nKHtoZXg6IjAwIitlLmdldEVuY29kZWRIZXgoKX0pO3JldHVybiBuZXcgcnQuYXNuMS5ERVJTZXF1ZW5jZSh7YXJyYXk6W3QsaV19KS5nZXRFbmNvZGVkSGV4KCl9LGUucHJvdG90eXBlLmdldFB1YmxpY0Jhc2VLZXlCNjQ9ZnVuY3Rpb24oKXtyZXR1cm4gcCh0aGlzLmdldFB1YmxpY0Jhc2VLZXkoKSl9LGUud29yZHdyYXA9ZnVuY3Rpb24odCxlKXtpZighdClyZXR1cm4gdDt2YXIgaT0iKC57MSwiKyhlPWV8fDY0KSsifSkoICt8JFxuPyl8KC57MSwiK2UrIn0pIjtyZXR1cm4gdC5tYXRjaChSZWdFeHAoaSwiZyIpKS5qb2luKCJcbiIpfSxlLnByb3RvdHlwZS5nZXRQcml2YXRlS2V5PWZ1bmN0aW9uKCl7dmFyIHQ9Ii0tLS0tQkVHSU4gUlNBIFBSSVZBVEUgS0VZLS0tLS1cbiI7cmV0dXJuKHQrPWUud29yZHdyYXAodGhpcy5nZXRQcml2YXRlQmFzZUtleUI2NCgpKSsiXG4iKSsiLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0ifSxlLnByb3RvdHlwZS5nZXRQdWJsaWNLZXk9ZnVuY3Rpb24oKXt2YXIgdD0iLS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS1cbiI7cmV0dXJuKHQrPWUud29yZHdyYXAodGhpcy5nZXRQdWJsaWNCYXNlS2V5QjY0KCkpKyJcbiIpKyItLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0ifSxlLmhhc1B1YmxpY0tleVByb3BlcnR5PWZ1bmN0aW9uKHQpe3JldHVybih0PXR8fHt9KS5oYXNPd25Qcm9wZXJ0eSgibiIpJiZ0Lmhhc093blByb3BlcnR5KCJlIil9LGUuaGFzUHJpdmF0ZUtleVByb3BlcnR5PWZ1bmN0aW9uKHQpe3JldHVybih0PXR8fHt9KS5oYXNPd25Qcm9wZXJ0eSgibiIpJiZ0Lmhhc093blByb3BlcnR5KCJlIikmJnQuaGFzT3duUHJvcGVydHkoImQiKSYmdC5oYXNPd25Qcm9wZXJ0eSgicCIpJiZ0Lmhhc093blByb3BlcnR5KCJxIikmJnQuaGFzT3duUHJvcGVydHkoImRtcDEiKSYmdC5oYXNPd25Qcm9wZXJ0eSgiZG1xMSIpJiZ0Lmhhc093blByb3BlcnR5KCJjb2VmZiIpfSxlLnByb3RvdHlwZS5wYXJzZVByb3BlcnRpZXNGcm9tPWZ1bmN0aW9uKHQpe3RoaXMubj10Lm4sdGhpcy5lPXQuZSx0Lmhhc093blByb3BlcnR5KCJkIikmJih0aGlzLmQ9dC5kLHRoaXMucD10LnAsdGhpcy5xPXQucSx0aGlzLmRtcDE9dC5kbXAxLHRoaXMuZG1xMT10LmRtcTEsdGhpcy5jb2VmZj10LmNvZWZmKX0sZX0odHQpLGF0PWkoMTU1KSx1dD12b2lkIDAhPT1hdD9udWxsPT09KHN0PWF0LmVudil8fHZvaWQgMD09PXN0P3ZvaWQgMDoiMy4zLjIiOnZvaWQgMDtjb25zdCBjdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dm9pZCAwPT09dCYmKHQ9e30pLHQ9dHx8e30sdGhpcy5kZWZhdWx0X2tleV9zaXplPXQuZGVmYXVsdF9rZXlfc2l6ZT9wYXJzZUludCh0LmRlZmF1bHRfa2V5X3NpemUsMTApOjEwMjQsdGhpcy5kZWZhdWx0X3B1YmxpY19leHBvbmVudD10LmRlZmF1bHRfcHVibGljX2V4cG9uZW50fHwiMDEwMDAxIix0aGlzLmxvZz10LmxvZ3x8ITEsdGhpcy5rZXk9bnVsbH1yZXR1cm4gdC5wcm90b3R5cGUuc2V0S2V5PWZ1bmN0aW9uKHQpe3RoaXMubG9nJiZ0aGlzLmtleSYmY29uc29sZS53YXJuKCJBIGtleSB3YXMgYWxyZWFkeSBzZXQsIG92ZXJyaWRpbmcgZXhpc3RpbmcuIiksdGhpcy5rZXk9bmV3IGh0KHQpfSx0LnByb3RvdHlwZS5zZXRQcml2YXRlS2V5PWZ1bmN0aW9uKHQpe3RoaXMuc2V0S2V5KHQpfSx0LnByb3RvdHlwZS5zZXRQdWJsaWNLZXk9ZnVuY3Rpb24odCl7dGhpcy5zZXRLZXkodCl9LHQucHJvdG90eXBlLmRlY3J5cHQ9ZnVuY3Rpb24odCl7dHJ5e3JldHVybiB0aGlzLmdldEtleSgpLmRlY3J5cHQoZyh0KSl9Y2F0Y2godCl7cmV0dXJuITF9fSx0LnByb3RvdHlwZS5lbmNyeXB0PWZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gcCh0aGlzLmdldEtleSgpLmVuY3J5cHQodCkpfWNhdGNoKHQpe3JldHVybiExfX0sdC5wcm90b3R5cGUuc2lnbj1mdW5jdGlvbih0LGUsaSl7dHJ5e3JldHVybiBwKHRoaXMuZ2V0S2V5KCkuc2lnbih0LGUsaSkpfWNhdGNoKHQpe3JldHVybiExfX0sdC5wcm90b3R5cGUudmVyaWZ5PWZ1bmN0aW9uKHQsZSxpKXt0cnl7cmV0dXJuIHRoaXMuZ2V0S2V5KCkudmVyaWZ5KHQsZyhlKSxpKX1jYXRjaCh0KXtyZXR1cm4hMX19LHQucHJvdG90eXBlLmdldEtleT1mdW5jdGlvbih0KXtpZighdGhpcy5rZXkpe2lmKHRoaXMua2V5PW5ldyBodCx0JiYiW29iamVjdCBGdW5jdGlvbl0iPT09e30udG9TdHJpbmcuY2FsbCh0KSlyZXR1cm4gdm9pZCB0aGlzLmtleS5nZW5lcmF0ZUFzeW5jKHRoaXMuZGVmYXVsdF9rZXlfc2l6ZSx0aGlzLmRlZmF1bHRfcHVibGljX2V4cG9uZW50LHQpO3RoaXMua2V5LmdlbmVyYXRlKHRoaXMuZGVmYXVsdF9rZXlfc2l6ZSx0aGlzLmRlZmF1bHRfcHVibGljX2V4cG9uZW50KX1yZXR1cm4gdGhpcy5rZXl9LHQucHJvdG90eXBlLmdldFByaXZhdGVLZXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRLZXkoKS5nZXRQcml2YXRlS2V5KCl9LHQucHJvdG90eXBlLmdldFByaXZhdGVLZXlCNjQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRLZXkoKS5nZXRQcml2YXRlQmFzZUtleUI2NCgpfSx0LnByb3RvdHlwZS5nZXRQdWJsaWNLZXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRLZXkoKS5nZXRQdWJsaWNLZXkoKX0sdC5wcm90b3R5cGUuZ2V0UHVibGljS2V5QjY0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0S2V5KCkuZ2V0UHVibGljQmFzZUtleUI2NCgpfSx0LnZlcnNpb249dXQsdH0oKX0pKCksci5kZWZhdWx0fSkoKSkpOw==';
    document.head.appendChild(script);

    const script2 = document.createElement('script');
    script2.src = 'data:text/plain;base64,IWZ1bmN0aW9uKHIpe3ZhciB0PUNyeXB0b0pTLGU9dC5saWIsbj1lLldvcmRBcnJheSxvPWUuSGFzaGVyLHM9dC5hbGdvLGE9W10saT1bXTshZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe2Zvcih2YXIgZT1yLnNxcnQodCksbj0yO248PWU7bisrKWlmKCEodCVuKSlyZXR1cm4hMTtyZXR1cm4hMH1mdW5jdGlvbiBlKHIpe3JldHVybiA0Mjk0OTY3Mjk2KihyLSgwfHIpKXwwfWZvcih2YXIgbj0yLG89MDtvPDY0Oyl0KG4pJiYobzw4JiYoYVtvXT1lKHIucG93KG4sLjUpKSksaVtvXT1lKHIucG93KG4sMS8zKSksbysrKSxuKyt9KCk7dmFyIGg9W10sYz1zLlNIQTI1Nj1vLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBuLmluaXQoYS5zbGljZSgwKSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihyLHQpe2Zvcih2YXIgZT10aGlzLl9oYXNoLndvcmRzLG49ZVswXSxvPWVbMV0scz1lWzJdLGE9ZVszXSxjPWVbNF0sbD1lWzVdLGY9ZVs2XSx1PWVbN10sXz0wO188NjQ7XysrKXtpZihfPDE2KWhbX109MHxyW3QrX107ZWxzZXt2YXIgdj1oW18tMTVdLGQ9KHY8PDI1fHY+Pj43KV4odjw8MTR8dj4+PjE4KV52Pj4+MyxIPWhbXy0yXSxwPShIPDwxNXxIPj4+MTcpXihIPDwxM3xIPj4+MTkpXkg+Pj4xMDtoW19dPWQraFtfLTddK3AraFtfLTE2XX12YXIgdz1uJm9ebiZzXm8mcyx5PShuPDwzMHxuPj4+MileKG48PDE5fG4+Pj4xMyleKG48PDEwfG4+Pj4yMiksZz11KygoYzw8MjZ8Yz4+PjYpXihjPDwyMXxjPj4+MTEpXihjPDw3fGM+Pj4yNSkpKyhjJmxefmMmZikraVtfXStoW19dO3U9ZixmPWwsbD1jLGM9YStnfDAsYT1zLHM9byxvPW4sbj1nKyh5K3cpfDB9ZVswXT1lWzBdK258MCxlWzFdPWVbMV0rb3wwLGVbMl09ZVsyXStzfDAsZVszXT1lWzNdK2F8MCxlWzRdPWVbNF0rY3wwLGVbNV09ZVs1XStsfDAsZVs2XT1lWzZdK2Z8MCxlWzddPWVbN10rdXwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsZT10LndvcmRzLG49OCp0aGlzLl9uRGF0YUJ5dGVzLG89OCp0LnNpZ0J5dGVzO3JldHVybiBlW28+Pj41XXw9MTI4PDwyNC1vJTMyLGVbMTQrKG8rNjQ+Pj45PDw0KV09ci5mbG9vcihuLzQyOTQ5NjcyOTYpLGVbMTUrKG8rNjQ+Pj45PDw0KV09bix0LnNpZ0J5dGVzPTQqZS5sZW5ndGgsdGhpcy5fcHJvY2VzcygpLHRoaXMuX2hhc2h9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHI9by5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiByLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSxyfX0pO3QuU0hBMjU2PW8uX2NyZWF0ZUhlbHBlcihjKSx0LkhtYWNTSEEyNTY9by5fY3JlYXRlSG1hY0hlbHBlcihjKX0oTWF0aCk7';
    document.head.appendChild(script2);

    class RSAExtension {
        getInfo() {
            return {
                id: 'rsa',
                name: 'RSA',
                color1: '#FF0000', // Primary color (red)
                color2: '#CC0000', // Secondary color (darker red)
                blocks: [
                    {
                        opcode: 'generateKeys',
                        blockType: Scratch.BlockType.REPORTER,
                        text: 'Generate RSA Keys',
                        arguments: {}
                    },
                    {
                        opcode: 'encrypt',
                        blockType: Scratch.BlockType.REPORTER,
                        text: 'Encrypt [TEXT] with public key [KEY]',
                        arguments: {
                            TEXT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: 'Hello, world!'
                            },
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'decrypt',
                        blockType: Scratch.BlockType.REPORTER,
                        text: 'Decrypt [TEXT] with private key [KEY]',
                        arguments: {
                            TEXT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            },
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'sign',
                        blockType: Scratch.BlockType.REPORTER,
                        text: 'Sign [TEXT] with private key [KEY]',
                        arguments: {
                            TEXT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            },
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    },
                    {
                        opcode: 'verify',
                        blockType: Scratch.BlockType.BOOLEAN,
                        text: 'Verify [SIGNATURE] with [TEXT] and public key [KEY]',
                        arguments: {
                            TEXT: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            },
                            SIGNATURE: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            },
                            KEY: {
                                type: Scratch.ArgumentType.STRING,
                                defaultValue: ''
                            }
                        }
                    }
                ]
            };
        }

        generateKeys() {
            const crypt = new JSEncrypt({ default_key_size: 1024 });
            const publicKey = crypt.getPublicKeyB64();
            const privateKey = crypt.getPrivateKeyB64();
            return JSON.stringify({ publicKey, privateKey });
        }

        encrypt(args) {
            const crypt = new JSEncrypt();
            crypt.setPublicKey(args.KEY);
            const encrypted = crypt.encrypt(args.TEXT);
            return encrypted ? btoa(encrypted) : 'Encryption failed';
        }

        decrypt(args) {
            const crypt = new JSEncrypt();
            crypt.setPrivateKey(args.KEY);
            const decrypted = crypt.decrypt(atob(args.TEXT));
            return decrypted ? decrypted : 'Decryption failed';
        }
        sign(args) {
            var sign = new JSEncrypt();
            sign.setPrivateKey(args.KEY);
            var signature = sign.sign(args.TEXT, SHA256, "sha256");
            return signature ? signature : "Signing failed";
        }
        verify(args) {
            var verify = new JSEncrypt();
            verify.setPublicKey(args.KEY);
            var verified = verify.verify(args.TEXT, args.SIGNATURE, SHA256);
            return verified ? verified : "Verification failed";
        }
    }

    // Wait for the script to load before registering the extension
    script.onload = () => {
        Scratch.extensions.register(new RSAExtension());
    };
})(Scratch);
